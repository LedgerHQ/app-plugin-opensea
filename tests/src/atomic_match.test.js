import "core-js/stable";
import "regenerator-runtime/runtime";
import { waitForAppScreen, zemu, txFromEtherscan, boilerplateJSON, resolutionConfig, loadConfig } from './test.fixture';
import ledgerService from "@ledgerhq/hw-app-eth/lib/services/ledger"

// from https://etherscan.io/tx/0x0a863562ee39b566d2eac1d11f0bcefab4fac12c26dc300fa8ad0df3a142afad //
// but 'buy-maker' address changed to match ledger address (0x5b1a00402c6aabc799aa30d009fb26ec7980ba0a -> 0xfe984369ce3919aa7bb4f431082d027b4f8ed70c)
test('[Nano S] nanos_atomicMatch_buyNow_single_nftName_eth', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0x02f909da01288459682f00851fb1117a6983048ba4947be8076f4ea4a4ad08075c2508e481d6c946d12b8803544bc7699dc000b90964ab834bab0000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000fe984369ce3919aa7bb4f431082d027b4f8ed70c0000000000000000000000001b33b9d0322d84434cc217c76611902515db8b5c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000bd3531da5cf5857e7cfaa92426877b022e612cf8000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b0000000000000000000000001b33b9d0322d84434cc217c76611902515db8b5c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000bd3531da5cf5857e7cfaa92426877b022e612cf80000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003544bc7699dc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000615ee5230000000000000000000000000000000000000000000000000000000000000000868eafdfe2c6c007d65a7d28b4465db1874b404b85c1a1b0beedfc99ea95feec00000000000000000000000000000000000000000000000000000000000004b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003544bc7699dc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000615edd760000000000000000000000000000000000000000000000000000000061602f3442dd9c6e64919f8eab37953ea61a908e88263c5ae9cc95235a2132ae58390aa90000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006a0000000000000000000000000000000000000000000000000000000000000074000000000000000000000000000000000000000000000000000000000000007e0000000000000000000000000000000000000000000000000000000000000088000000000000000000000000000000000000000000000000000000000000009200000000000000000000000000000000000000000000000000000000000000940000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000001c7b8fc5efce71806fbd743448ef59f2ddbc5532dd74d5f4bb410a9d4cfae908475c6d9c246b7e4a8bd0d3f810f70015a4f95cf02530b13bb6510e3115907bf6b17b8fc5efce71806fbd743448ef59f2ddbc5532dd74d5f4bb410a9d4cfae908475c6d9c246b7e4a8bd0d3f810f70015a4f95cf02530b13bb6510e3115907bf6b10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006423b872dd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000fe984369ce3919aa7bb4f431082d027b4f8ed70c000000000000000000000000000000000000000000000000000000000000194700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006423b872dd0000000000000000000000001b33b9d0322d84434cc217c76611902515db8b5c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000194700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006400000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c001a0c3002685040139688670f9024ae7379987c4746b4776ebdbf714d2a28503087fa01dae01bc11fd28525711e6cd19ce58c042b6b07a6121d19056a91507a0595a27");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig,
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution,
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'nanos_atomicMatch_buyNow_single_nftName_eth', [11, 0]);
  await tx;
}));

// from https://etherscan.io/tx/0x0a863562ee39b566d2eac1d11f0bcefab4fac12c26dc300fa8ad0df3a142afad
// but 'buy-maker' address changed to match ledger address (0x5b1a00402c6aabc799aa30d009fb26ec7980ba0a -> 0xfe984369ce3919aa7bb4f431082d027b4f8ed70c), also nft contract address is modified in order to get address displayed instead of name (bd445 -> bd446).
test('[Nano S] nanos_atomicMatch_buyNow_single_nftAddress_eth', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0x02f909da01288459682f00851fb1117a6983048ba4947be8076f4ea4a4ad08075c2508e481d6c946d12b8803544bc7699dc000b90964ab834bab0000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000fe984369ce3919aa7bb4f431082d027b4f8ed70c0000000000000000000000001b33b9d0322d84434cc217c76611902515db8b5c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000bd4465da5929d5639ee098abfaa3241e9ae111af000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b0000000000000000000000001b33b9d0322d84434cc217c76611902515db8b5c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000bd4455da5929d5639ee098abfaa3241e9ae111af0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003544bc7699dc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000615ee5230000000000000000000000000000000000000000000000000000000000000000868eafdfe2c6c007d65a7d28b4465db1874b404b85c1a1b0beedfc99ea95feec00000000000000000000000000000000000000000000000000000000000004b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003544bc7699dc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000615edd760000000000000000000000000000000000000000000000000000000061602f3442dd9c6e64919f8eab37953ea61a908e88263c5ae9cc95235a2132ae58390aa90000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006a0000000000000000000000000000000000000000000000000000000000000074000000000000000000000000000000000000000000000000000000000000007e0000000000000000000000000000000000000000000000000000000000000088000000000000000000000000000000000000000000000000000000000000009200000000000000000000000000000000000000000000000000000000000000940000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000001c7b8fc5efce71806fbd743448ef59f2ddbc5532dd74d5f4bb410a9d4cfae908475c6d9c246b7e4a8bd0d3f810f70015a4f95cf02530b13bb6510e3115907bf6b17b8fc5efce71806fbd743448ef59f2ddbc5532dd74d5f4bb410a9d4cfae908475c6d9c246b7e4a8bd0d3f810f70015a4f95cf02530b13bb6510e3115907bf6b10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006423b872dd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000fe984369ce3919aa7bb4f431082d027b4f8ed70c000000000000000000000000000000000000000000000000000000000000194700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006423b872dd0000000000000000000000001b33b9d0322d84434cc217c76611902515db8b5c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000194700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006400000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c001a0c3002685040139688670f9024ae7379987c4746b4776ebdbf714d2a28503087fa01dae01bc11fd28525711e6cd19ce58c042b6b07a6121d19056a91507a0595a27");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig,
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution,
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'nanos_atomicMatch_buyNow_single_nftAddress_eth', [11, 0]);
  await tx;
}));

// from https://etherscan.io/tx/0x0a863562ee39b566d2eac1d11f0bcefab4fac12c26dc300fa8ad0df3a142afad
// Ledger address does not match 'from' address.
test('[Nano S] nanos_atomicMatch_buyNow_single_nftAddress_eth_warning', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0x02f909da01288459682f00851fb1117a6983048ba4947be8076f4ea4a4ad08075c2508e481d6c946d12b8803544bc7699dc000b90964ab834bab0000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b0000000000000000000000005b1a00402c6aabc799aa30d009fb26ec7980ba0a0000000000000000000000001b33b9d0322d84434cc217c76611902515db8b5c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000bd4455da5929d5639ee098abfaa3241e9ae111af000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b0000000000000000000000001b33b9d0322d84434cc217c76611902515db8b5c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000bd4455da5929d5639ee098abfaa3241e9ae111af0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003544bc7699dc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000615ee5230000000000000000000000000000000000000000000000000000000000000000868eafdfe2c6c007d65a7d28b4465db1874b404b85c1a1b0beedfc99ea95feec00000000000000000000000000000000000000000000000000000000000004b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003544bc7699dc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000615edd760000000000000000000000000000000000000000000000000000000061602f3442dd9c6e64919f8eab37953ea61a908e88263c5ae9cc95235a2132ae58390aa90000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006a0000000000000000000000000000000000000000000000000000000000000074000000000000000000000000000000000000000000000000000000000000007e0000000000000000000000000000000000000000000000000000000000000088000000000000000000000000000000000000000000000000000000000000009200000000000000000000000000000000000000000000000000000000000000940000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000001c7b8fc5efce71806fbd743448ef59f2ddbc5532dd74d5f4bb410a9d4cfae908475c6d9c246b7e4a8bd0d3f810f70015a4f95cf02530b13bb6510e3115907bf6b17b8fc5efce71806fbd743448ef59f2ddbc5532dd74d5f4bb410a9d4cfae908475c6d9c246b7e4a8bd0d3f810f70015a4f95cf02530b13bb6510e3115907bf6b10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006423b872dd00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b1a00402c6aabc799aa30d009fb26ec7980ba0a000000000000000000000000000000000000000000000000000000000000194700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006423b872dd0000000000000000000000001b33b9d0322d84434cc217c76611902515db8b5c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000194700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006400000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c001a0c3002685040139688670f9024ae7379987c4746b4776ebdbf714d2a28503087fa01dae01bc11fd28525711e6cd19ce58c042b6b07a6121d19056a91507a0595a27");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig,
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution,
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'nanos_atomicMatch_buyNow_single_nftAddress_eth_warning', [13, 0]);
  await tx;
}));

// from https://etherscan.io/tx/0x0a863562ee39b566d2eac1d11f0bcefab4fac12c26dc300fa8ad0df3a142afad
// but 'buy-maker' address changed to match ledger address (0x5b1a00402c6aabc799aa30d009fb26ec7980ba0a -> 0xfe984369ce3919aa7bb4f431082d027b4f8ed70c). Also, sell-side transfer method has been modified to raise method not found ui (23b8 -> 23b9)
test('[Nano S] nanos_atomicMatch_buyNow_unknownMethod_nftAddress_eth', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0x02f909da01288459682f00851fb1117a6983048ba4947be8076f4ea4a4ad08075c2508e481d6c946d12b8803544bc7699dc000b90964ab834bab0000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000fe984369ce3919aa7bb4f431082d027b4f8ed70c0000000000000000000000001b33b9d0322d84434cc217c76611902515db8b5c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000bd4455da5929d5639ee098abfaa3241e9ae111af000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b0000000000000000000000001b33b9d0322d84434cc217c76611902515db8b5c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000bd4455da5929d5639ee098abfaa3241e9ae111af0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003544bc7699dc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000615ee5230000000000000000000000000000000000000000000000000000000000000000868eafdfe2c6c007d65a7d28b4465db1874b404b85c1a1b0beedfc99ea95feec00000000000000000000000000000000000000000000000000000000000004b000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003544bc7699dc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000615edd760000000000000000000000000000000000000000000000000000000061602f3442dd9c6e64919f8eab37953ea61a908e88263c5ae9cc95235a2132ae58390aa90000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006a0000000000000000000000000000000000000000000000000000000000000074000000000000000000000000000000000000000000000000000000000000007e0000000000000000000000000000000000000000000000000000000000000088000000000000000000000000000000000000000000000000000000000000009200000000000000000000000000000000000000000000000000000000000000940000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000001c7b8fc5efce71806fbd743448ef59f2ddbc5532dd74d5f4bb410a9d4cfae908475c6d9c246b7e4a8bd0d3f810f70015a4f95cf02530b13bb6510e3115907bf6b17b8fc5efce71806fbd743448ef59f2ddbc5532dd74d5f4bb410a9d4cfae908475c6d9c246b7e4a8bd0d3f810f70015a4f95cf02530b13bb6510e3115907bf6b10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006423b972dd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000fe984369ce3919aa7bb4f431082d027b4f8ed70c000000000000000000000000000000000000000000000000000000000000194700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006423b972dd0000000000000000000000001b33b9d0322d84434cc217c76611902515db8b5c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000194700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006400000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c001a0c3002685040139688670f9024ae7379987c4746b4776ebdbf714d2a28503087fa01dae01bc11fd28525711e6cd19ce58c042b6b07a6121d19056a91507a0595a27");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig,
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution,
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'nanos_atomicMatch_buyNow_unknownMethod_nftAddress_eth', [12, 0]);
  await tx;
}));

// from https://etherscan.io/tx/0xfb7ea354650bf5c5dcb84340c9da9ec092bf296a1ff81302da9d449c086bdbac
test('[Nano S] nanos_atomicMatch_accept_single_nftAddress_weth', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0x02f909d4018201b98477359400852388f99c508305b632947be8076f4ea4a4ad08075c2508e481d6c946d12b80b90964ab834bab0000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000d15a3cddebd2f841b9fb7e213ee9df89577fba0500000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c0107300000000000000000000000073883743dd9894bd2d43e975465b50df8d3af3b20000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc20000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b0000000000000000000000009086b1f411cb815197c01abffe9277ad2a30ca8e000000000000000000000000d15a3cddebd2f841b9fb7e213ee9df89577fba05000000000000000000000000000000000000000000000000000000000000000000000000000000000000000073883743dd9894bd2d43e975465b50df8d3af3b20000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003520000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008251670c2ad4000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000615eb363000000000000000000000000000000000000000000000000000000006160054360f4800b6f4d60203cad43bcf54e9a696cb004b3744fb367d2bf982bcae46d42000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003520000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008251670c2ad4000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000615efb5900000000000000000000000000000000000000000000000000000000000000000161ed3b01f05c59fbd857d14013f4c6becb462f2688fc2aa4f37e256dcede2e0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006a0000000000000000000000000000000000000000000000000000000000000074000000000000000000000000000000000000000000000000000000000000007e0000000000000000000000000000000000000000000000000000000000000088000000000000000000000000000000000000000000000000000000000000009200000000000000000000000000000000000000000000000000000000000000940000000000000000000000000000000000000000000000000000000000000001b000000000000000000000000000000000000000000000000000000000000001bd2c3fdf5ac1239c39a4ae42f9d4e3662fc235c61dc46f5cd182c8df93c2de3902fc874e3f98d22e07381a7fb86a96acfa4f0837383eb2aa6b752569347dbe845d2c3fdf5ac1239c39a4ae42f9d4e3662fc235c61dc46f5cd182c8df93c2de3902fc874e3f98d22e07381a7fb86a96acfa4f0837383eb2aa6b752569347dbe8450000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006423b872dd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000d15a3cddebd2f841b9fb7e213ee9df89577fba05000000000000000000000000000000000000000000000000000000000000148a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006423b872dd0000000000000000000000009086b1f411cb815197c01abffe9277ad2a30ca8e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000148a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006400000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c080a03581f72131f9dca69c6d69e3567312d6ec9c76d7e6cddec2c9cdc5a3dbd69c68a054412fcc69ffaee92f2d82c45d26ab0561bc154fdaf04f334548729ccbcd81be");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig,
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution,
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'nanos_atomicMatch_accept_single_nftAddress_weth', [11, 0]);
  await tx;
}));

// from https://etherscan.io/tx/0xfb7ea354650bf5c5dcb84340c9da9ec092bf296a1ff81302da9d449c086bdbac
// but WETH address is misstyped : c02aaa -> c02baa to raise unknown token warning.
test('[Nano S] nanos_atomicMatch_accept_single_nftAddress_unknownToken', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0x02f909d4018201b98477359400852388f99c508305b632947be8076f4ea4a4ad08075c2508e481d6c946d12b80b90964ab834bab0000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000d15a3cddebd2f841b9fb7e213ee9df89577fba0500000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c0107300000000000000000000000073883743dd9894bd2d43e975465b50df8d3af3b20000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c02baa39b223fe8d0a0e5c4f27ead9083c756cc20000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b0000000000000000000000009086b1f411cb815197c01abffe9277ad2a30ca8e000000000000000000000000d15a3cddebd2f841b9fb7e213ee9df89577fba05000000000000000000000000000000000000000000000000000000000000000000000000000000000000000073883743dd9894bd2d43e975465b50df8d3af3b20000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c02baa39b223fe8d0a0e5c4f27ead9083c756cc2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003520000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008251670c2ad4000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000615eb363000000000000000000000000000000000000000000000000000000006160054360f4800b6f4d60203cad43bcf54e9a696cb004b3744fb367d2bf982bcae46d42000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003520000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000008251670c2ad4000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000615efb5900000000000000000000000000000000000000000000000000000000000000000161ed3b01f05c59fbd857d14013f4c6becb462f2688fc2aa4f37e256dcede2e0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006a0000000000000000000000000000000000000000000000000000000000000074000000000000000000000000000000000000000000000000000000000000007e0000000000000000000000000000000000000000000000000000000000000088000000000000000000000000000000000000000000000000000000000000009200000000000000000000000000000000000000000000000000000000000000940000000000000000000000000000000000000000000000000000000000000001b000000000000000000000000000000000000000000000000000000000000001bd2c3fdf5ac1239c39a4ae42f9d4e3662fc235c61dc46f5cd182c8df93c2de3902fc874e3f98d22e07381a7fb86a96acfa4f0837383eb2aa6b752569347dbe845d2c3fdf5ac1239c39a4ae42f9d4e3662fc235c61dc46f5cd182c8df93c2de3902fc874e3f98d22e07381a7fb86a96acfa4f0837383eb2aa6b752569347dbe8450000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006423b872dd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000d15a3cddebd2f841b9fb7e213ee9df89577fba05000000000000000000000000000000000000000000000000000000000000148a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006423b872dd0000000000000000000000009086b1f411cb815197c01abffe9277ad2a30ca8e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000148a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006400000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c080a03581f72131f9dca69c6d69e3567312d6ec9c76d7e6cddec2c9cdc5a3dbd69c68a054412fcc69ffaee92f2d82c45d26ab0561bc154fdaf04f334548729ccbcd81be");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig,
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution,
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'nanos_atomicMatch_accept_single_nftAddress_unknownToken', [15, 0]);
  await tx;
}));


// from https://etherscan.io/tx/0xc9361abaa6fd920b34e506158b860170ed2e51faa40967df7ddfe6b2eecec4cf
// but 'buy-maker' address has been modified to match ledger (0x80163e9126260e34851ffd82db2f2897c8751e50 -> 0xfe984369ce3919aa7bb4f431082d027b4f8ed70c)
test('[Nano S] nanos_atomicMatch_buyNow_bundle_nftAddress_eth', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0x02f91a5c0182020e8459682f008513cc101270830a67be947be8076f4ea4a4ad08075c2508e481d6c946d12b880f9ccd8a1c508000b919e4ab834bab0000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000fe984369ce3919aa7bb4f431082d027b4f8ed70c000000000000000000000000e6a1379df8ef4ce6f7d5c0371b964b34d0fdff840000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c5000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000e6a1379df8ef4ce6f7d5c0371b964b34d0fdff8400000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f9ccd8a1c50800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000061617a0400000000000000000000000000000000000000000000000000000000000000004056f7ef488bbfea0e0a014bea37cfc0a182a9cf29d2553b73345b3af748044700000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f9ccd8a1c5080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006117f5ae00000000000000000000000000000000000000000000000000000000000000007cab06a9ae290a73af48938031a8850c7183ee394acc7e594644b2ba5c6d935f0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000006a00000000000000000000000000000000000000000000000000000000000000b60000000000000000000000000000000000000000000000000000000000000102000000000000000000000000000000000000000000000000000000000000014e000000000000000000000000000000000000000000000000000000000000019a000000000000000000000000000000000000000000000000000000000000019c0000000000000000000000000000000000000000000000000000000000000001b000000000000000000000000000000000000000000000000000000000000001be7cd607b109b693ddeb92f13e08cb71480e18afdd212964d02eaa719b8d2f4c111d75078ffb58203e8ddb5a77aa6a0233ca0ff691bb2eb6886b81a24b010010ce7cd607b109b693ddeb92f13e08cb71480e18afdd212964d02eaa719b8d2f4c111d75078ffb58203e8ddb5a77aa6a0233ca0ff691bb2eb6886b81a24b010010c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000048468f0bcaa0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001800000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000300000000000000000000000074ee68a33f6c9f113e22b3b77418b75f85d07d2200000000000000000000000074ee68a33f6c9f113e22b3b77418b75f85d07d2200000000000000000000000074ee68a33f6c9f113e22b3b77418b75f85d07d220000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c4000000000000000000000000000000000000000000000000000000000000024cf242432a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000fe984369ce3919aa7bb4f431082d027b4f8ed70c0000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000fe984369ce3919aa7bb4f431082d027b4f8ed70c0000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000fe984369ce3919aa7bb4f431082d027b4f8ed70c0000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000048468f0bcaa0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001800000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000300000000000000000000000074ee68a33f6c9f113e22b3b77418b75f85d07d2200000000000000000000000074ee68a33f6c9f113e22b3b77418b75f85d07d2200000000000000000000000074ee68a33f6c9f113e22b3b77418b75f85d07d220000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c4000000000000000000000000000000000000000000000000000000000000024cf242432a000000000000000000000000e6a1379df8ef4ce6f7d5c0371b964b34d0fdff8400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a000000000000000000000000e6a1379df8ef4ce6f7d5c0371b964b34d0fdff8400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a000000000000000000000000e6a1379df8ef4ce6f7d5c0371b964b34d0fdff8400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000484000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004840000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c001a0413eec95288313973d26e7a0417a74fc9582a21536fdc40d9bc2539d1937a84aa05deec3d439d5c3b6a011add1796247777ea8c8dfe260e6e823d44bd69315a9ef");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig,
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution,
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'nanos_atomicMatch_buyNow_bundle_nftAddress_eth', [11, 0]);
  await tx;
}));

// from https://etherscan.io/tx/0xc9361abaa6fd920b34e506158b860170ed2e51faa40967df7ddfe6b2eecec4cf
// but 'taker' address does not match ledger's. 
test('[Nano S] nanos_atomicMatch_buyNow_bundle_nftAddress_eth_warning', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0x02f91a5c0182020e8459682f008513cc101270830a67be947be8076f4ea4a4ad08075c2508e481d6c946d12b880f9ccd8a1c508000b919e4ab834bab0000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b00000000000000000000000080163e9126260e34851ffd82db2f2897c8751e50000000000000000000000000e6a1379df8ef4ce6f7d5c0371b964b34d0fdff840000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c5000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000e6a1379df8ef4ce6f7d5c0371b964b34d0fdff8400000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f9ccd8a1c50800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000061617a0400000000000000000000000000000000000000000000000000000000000000004056f7ef488bbfea0e0a014bea37cfc0a182a9cf29d2553b73345b3af748044700000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f9ccd8a1c5080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006117f5ae00000000000000000000000000000000000000000000000000000000000000007cab06a9ae290a73af48938031a8850c7183ee394acc7e594644b2ba5c6d935f0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000006a00000000000000000000000000000000000000000000000000000000000000b60000000000000000000000000000000000000000000000000000000000000102000000000000000000000000000000000000000000000000000000000000014e000000000000000000000000000000000000000000000000000000000000019a000000000000000000000000000000000000000000000000000000000000019c0000000000000000000000000000000000000000000000000000000000000001b000000000000000000000000000000000000000000000000000000000000001be7cd607b109b693ddeb92f13e08cb71480e18afdd212964d02eaa719b8d2f4c111d75078ffb58203e8ddb5a77aa6a0233ca0ff691bb2eb6886b81a24b010010ce7cd607b109b693ddeb92f13e08cb71480e18afdd212964d02eaa719b8d2f4c111d75078ffb58203e8ddb5a77aa6a0233ca0ff691bb2eb6886b81a24b010010c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000048468f0bcaa0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001800000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000300000000000000000000000074ee68a33f6c9f113e22b3b77418b75f85d07d2200000000000000000000000074ee68a33f6c9f113e22b3b77418b75f85d07d2200000000000000000000000074ee68a33f6c9f113e22b3b77418b75f85d07d220000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c4000000000000000000000000000000000000000000000000000000000000024cf242432a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000080163e9126260e34851ffd82db2f2897c8751e500000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000080163e9126260e34851ffd82db2f2897c8751e500000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000080163e9126260e34851ffd82db2f2897c8751e500000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000048468f0bcaa0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001800000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000300000000000000000000000074ee68a33f6c9f113e22b3b77418b75f85d07d2200000000000000000000000074ee68a33f6c9f113e22b3b77418b75f85d07d2200000000000000000000000074ee68a33f6c9f113e22b3b77418b75f85d07d220000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c4000000000000000000000000000000000000000000000000000000000000024cf242432a000000000000000000000000e6a1379df8ef4ce6f7d5c0371b964b34d0fdff8400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a000000000000000000000000e6a1379df8ef4ce6f7d5c0371b964b34d0fdff8400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a000000000000000000000000e6a1379df8ef4ce6f7d5c0371b964b34d0fdff8400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000484000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004840000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c001a0413eec95288313973d26e7a0417a74fc9582a21536fdc40d9bc2539d1937a84aa05deec3d439d5c3b6a011add1796247777ea8c8dfe260e6e823d44bd69315a9ef");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig,
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution,
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'nanos_atomicMatch_buyNow_bundle_nftAddress_eth_warning', [13, 0]);
  await tx;
}));

// from https://etherscan.io/tx/0xc9361abaa6fd920b34e506158b860170ed2e51faa40967df7ddfe6b2eecec4cf
// but there are different adresses in atomicize calldatas (74ee ->74fe) and 'buy-maker' address is modified to match ledger (0x80163e9126260e34851ffd82db2f2897c8751e50 -> 0xfe984369ce3919aa7bb4f431082d027b4f8ed70c)
test('[Nano S] nanos_atomicMatch_buyNow_bundle_multiple_eth', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0x02f91a5c0182020e8459682f008513cc101270830a67be947be8076f4ea4a4ad08075c2508e481d6c946d12b880f9ccd8a1c508000b919e4ab834bab0000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000fe984369ce3919aa7bb4f431082d027b4f8ed70c000000000000000000000000e6a1379df8ef4ce6f7d5c0371b964b34d0fdff840000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c5000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000e6a1379df8ef4ce6f7d5c0371b964b34d0fdff8400000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f9ccd8a1c50800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000061617a0400000000000000000000000000000000000000000000000000000000000000004056f7ef488bbfea0e0a014bea37cfc0a182a9cf29d2553b73345b3af748044700000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f9ccd8a1c5080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006117f5ae00000000000000000000000000000000000000000000000000000000000000007cab06a9ae290a73af48938031a8850c7183ee394acc7e594644b2ba5c6d935f0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000006a00000000000000000000000000000000000000000000000000000000000000b60000000000000000000000000000000000000000000000000000000000000102000000000000000000000000000000000000000000000000000000000000014e000000000000000000000000000000000000000000000000000000000000019a000000000000000000000000000000000000000000000000000000000000019c0000000000000000000000000000000000000000000000000000000000000001b000000000000000000000000000000000000000000000000000000000000001be7cd607b109b693ddeb92f13e08cb71480e18afdd212964d02eaa719b8d2f4c111d75078ffb58203e8ddb5a77aa6a0233ca0ff691bb2eb6886b81a24b010010ce7cd607b109b693ddeb92f13e08cb71480e18afdd212964d02eaa719b8d2f4c111d75078ffb58203e8ddb5a77aa6a0233ca0ff691bb2eb6886b81a24b010010c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000048468f0bcaa0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001800000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000300000000000000000000000074ee68a33f6c9f113e22b3b77418b75f85d07d2200000000000000000000000074fe68a33f6c9f113e22b3b77418b75f85d07d2200000000000000000000000074ee68a33f6c9f113e22b3b77418b75f85d07d220000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c4000000000000000000000000000000000000000000000000000000000000024cf242432a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000080163e9126260e34851ffd82db2f2897c8751e500000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000080163e9126260e34851ffd82db2f2897c8751e500000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000080163e9126260e34851ffd82db2f2897c8751e500000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000048468f0bcaa0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001800000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000300000000000000000000000074ee68a33f6c9f113e22b3b77418b75f85d07d2200000000000000000000000074fe68a33f6c9f113e22b3b77418b75f85d07d2200000000000000000000000074ee68a33f6c9f113e22b3b77418b75f85d07d220000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c4000000000000000000000000000000000000000000000000000000000000024cf242432a000000000000000000000000e6a1379df8ef4ce6f7d5c0371b964b34d0fdff8400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a000000000000000000000000e6a1379df8ef4ce6f7d5c0371b964b34d0fdff8400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a000000000000000000000000e6a1379df8ef4ce6f7d5c0371b964b34d0fdff8400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000484000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004840000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c001a0413eec95288313973d26e7a0417a74fc9582a21536fdc40d9bc2539d1937a84aa05deec3d439d5c3b6a011add1796247777ea8c8dfe260e6e823d44bd69315a9ef");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig,
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution,
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'nanos_atomicMatch_buyNow_bundle_multiple_eth', [9, 0]);
  await tx;
}));

// from https://etherscan.io/tx/0xc9361abaa6fd920b34e506158b860170ed2e51faa40967df7ddfe6b2eecec4cf
// but there are different adresses in atomicize calldatas (74ee ->74fe) and 'buy-maker' address is modified to match ledger (0x80163e9126260e34851ffd82db2f2897c8751e50 -> 0xfe984369ce3919aa7bb4f431082d027b4f8ed70c)
test('[Nano S] nanos_atomicMatch_buyNow_bundle_multiple_eth_warning', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0x02f91a5c0182020e8459682f008513cc101270830a67be947be8076f4ea4a4ad08075c2508e481d6c946d12b880f9ccd8a1c508000b919e4ab834bab0000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b00000000000000000000000080163e9126260e34851ffd82db2f2897c8751e50000000000000000000000000e6a1379df8ef4ce6f7d5c0371b964b34d0fdff840000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c5000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000e6a1379df8ef4ce6f7d5c0371b964b34d0fdff8400000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f9ccd8a1c50800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000061617a0400000000000000000000000000000000000000000000000000000000000000004056f7ef488bbfea0e0a014bea37cfc0a182a9cf29d2553b73345b3af748044700000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f9ccd8a1c5080000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006117f5ae00000000000000000000000000000000000000000000000000000000000000007cab06a9ae290a73af48938031a8850c7183ee394acc7e594644b2ba5c6d935f0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000006a00000000000000000000000000000000000000000000000000000000000000b60000000000000000000000000000000000000000000000000000000000000102000000000000000000000000000000000000000000000000000000000000014e000000000000000000000000000000000000000000000000000000000000019a000000000000000000000000000000000000000000000000000000000000019c0000000000000000000000000000000000000000000000000000000000000001b000000000000000000000000000000000000000000000000000000000000001be7cd607b109b693ddeb92f13e08cb71480e18afdd212964d02eaa719b8d2f4c111d75078ffb58203e8ddb5a77aa6a0233ca0ff691bb2eb6886b81a24b010010ce7cd607b109b693ddeb92f13e08cb71480e18afdd212964d02eaa719b8d2f4c111d75078ffb58203e8ddb5a77aa6a0233ca0ff691bb2eb6886b81a24b010010c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000048468f0bcaa0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001800000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000300000000000000000000000074ee68a33f6c9f113e22b3b77418b75f85d07d2200000000000000000000000074fe68a33f6c9f113e22b3b77418b75f85d07d2200000000000000000000000074ee68a33f6c9f113e22b3b77418b75f85d07d220000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c4000000000000000000000000000000000000000000000000000000000000024cf242432a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000080163e9126260e34851ffd82db2f2897c8751e500000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000080163e9126260e34851ffd82db2f2897c8751e500000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000080163e9126260e34851ffd82db2f2897c8751e500000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000048468f0bcaa0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000001800000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000300000000000000000000000074ee68a33f6c9f113e22b3b77418b75f85d07d2200000000000000000000000074fe68a33f6c9f113e22b3b77418b75f85d07d2200000000000000000000000074ee68a33f6c9f113e22b3b77418b75f85d07d220000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000300000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c4000000000000000000000000000000000000000000000000000000000000024cf242432a000000000000000000000000e6a1379df8ef4ce6f7d5c0371b964b34d0fdff8400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a000000000000000000000000e6a1379df8ef4ce6f7d5c0371b964b34d0fdff8400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a000000000000000000000000e6a1379df8ef4ce6f7d5c0371b964b34d0fdff8400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000484000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004840000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c001a0413eec95288313973d26e7a0417a74fc9582a21536fdc40d9bc2539d1937a84aa05deec3d439d5c3b6a011add1796247777ea8c8dfe260e6e823d44bd69315a9ef");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig,
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution,
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'nanos_atomicMatch_buyNow_bundle_multiple_eth_warning', [11, 0]);
  await tx;
}));

//https://etherscan.io/tx/0x7fd83996604004bdddc09d89647cc4087ba4879f6f5a60263d29daa9b1552167
// but payment token c53a9c309ee2f3e333bd6eca806a31d0e2dca5c5 has been replaced to WETH and 'buy-maker' address has been modified to match ledger's (0xa756ef8e21fc7d0e9097aa41fd3467129eed798d -> 0xfe984369ce3919aa7bb4f431082d027b4f8ed70c). Also, contract address has been modified for 2nd token to raise 'multiple' screen. (a342 ->a343)
test('[Nano S] nanos_atomicMatch_buyNow_bundle_multiple_weth', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0xf915cb7c85109966c9ef83091fe2947be8076f4ea4a4ad08075c2508e481d6c946d12b80b91564ab834bab0000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000fe984369ce3919aa7bb4f431082d027b4f8ed70c000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c20000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc20000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c200000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc200000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e4e1c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000612b99ef0000000000000000000000000000000000000000000000000000000000000000d03a608d2402ed6e32a3585c28b55d8c06d957159f8d34a99772dabaa1dd800500000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e4e1c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006116cedc00000000000000000000000000000000000000000000000000000000000000000c7768501b78545bc74f553f49e5d8e8598a3874c35cf7618a212116791579170000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000006a00000000000000000000000000000000000000000000000000000000000000a400000000000000000000000000000000000000000000000000000000000000de0000000000000000000000000000000000000000000000000000000000000118000000000000000000000000000000000000000000000000000000000000015200000000000000000000000000000000000000000000000000000000000001540000000000000000000000000000000000000000000000000000000000000001b000000000000000000000000000000000000000000000000000000000000001bbc49b7add62873b9fd9cf7c666121f35b33ca5b593c89a9731d7fafea99210511ceee2d8981910b0f1daa7a76fad0c75edfee7f51e4ac7bca69103b72ad01956bc49b7add62873b9fd9cf7c666121f35b33ca5b593c89a9731d7fafea99210511ceee2d8981910b0f1daa7a76fad0c75edfee7f51e4ac7bca69103b72ad019560000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000036468f0bcaa000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000002000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000a343f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c40000000000000000000000000000000000000000000000000000000000000188f242432a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a756ef8e21fc7d0e9097aa41fd3467129eed798d67e1ab582fd4744c04a817593a089e82129bc18c000000000000000000801800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a756ef8e21fc7d0e9097aa41fd3467129eed798d7a9fe22691c811ea339d9b73150e6911a5343dca000000000000000007000800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000036468f0bcaa000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000002000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c40000000000000000000000000000000000000000000000000000000000000188f242432a000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c2000000000000000000000000000000000000000000000000000000000000000067e1ab582fd4744c04a817593a089e82129bc18c000000000000000000801800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c200000000000000000000000000000000000000000000000000000000000000007a9fe22691c811ea339d9b73150e6911a5343dca000000000000000007000800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000364000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003640000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000025a0ce12b41ada2bf52d5a2923fdc51ed95c47d0f76ddf4a7bf24daaab5acc8bc740a04dccf64d7d8a190e12931411402b1fe5fbc5cc1572a1ecc042be361606bece87");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig,
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution,
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'nanos_atomicMatch_buyNow_bundle_multiple_weth', [10, 0]);
  await tx;
}));

//https://etherscan.io/tx/0x7fd83996604004bdddc09d89647cc4087ba4879f6f5a60263d29daa9b1552167
// 'buy-maker' address has been modified to match ledger's (0xa756ef8e21fc7d0e9097aa41fd3467129eed798d -> 0xfe984369ce3919aa7bb4f431082d027b4f8ed70c). Also, contract address has been modified for 2nd token to raise 'multiple' screen. (a342 ->a343)
test('[Nano S] nanos_atomicMatch_buyNow_bundle_multiple_unknownToken', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0xf915cb7c85109966c9ef83091fe2947be8076f4ea4a4ad08075c2508e481d6c946d12b80b91564ab834bab0000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000fe984369ce3919aa7bb4f431082d027b4f8ed70c000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c20000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c53a9c309ee2f3e333bd6eca806a31d0e2dca5c50000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c200000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc200000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e4e1c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000612b99ef0000000000000000000000000000000000000000000000000000000000000000d03a608d2402ed6e32a3585c28b55d8c06d957159f8d34a99772dabaa1dd800500000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e4e1c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006116cedc00000000000000000000000000000000000000000000000000000000000000000c7768501b78545bc74f553f49e5d8e8598a3874c35cf7618a212116791579170000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000006a00000000000000000000000000000000000000000000000000000000000000a400000000000000000000000000000000000000000000000000000000000000de0000000000000000000000000000000000000000000000000000000000000118000000000000000000000000000000000000000000000000000000000000015200000000000000000000000000000000000000000000000000000000000001540000000000000000000000000000000000000000000000000000000000000001b000000000000000000000000000000000000000000000000000000000000001bbc49b7add62873b9fd9cf7c666121f35b33ca5b593c89a9731d7fafea99210511ceee2d8981910b0f1daa7a76fad0c75edfee7f51e4ac7bca69103b72ad01956bc49b7add62873b9fd9cf7c666121f35b33ca5b593c89a9731d7fafea99210511ceee2d8981910b0f1daa7a76fad0c75edfee7f51e4ac7bca69103b72ad019560000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000036468f0bcaa000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000002000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000a343f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c40000000000000000000000000000000000000000000000000000000000000188f242432a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a756ef8e21fc7d0e9097aa41fd3467129eed798d67e1ab582fd4744c04a817593a089e82129bc18c000000000000000000801800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a756ef8e21fc7d0e9097aa41fd3467129eed798d7a9fe22691c811ea339d9b73150e6911a5343dca000000000000000007000800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000036468f0bcaa000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000002000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c40000000000000000000000000000000000000000000000000000000000000188f242432a000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c2000000000000000000000000000000000000000000000000000000000000000067e1ab582fd4744c04a817593a089e82129bc18c000000000000000000801800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c200000000000000000000000000000000000000000000000000000000000000007a9fe22691c811ea339d9b73150e6911a5343dca000000000000000007000800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000364000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003640000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000025a0ce12b41ada2bf52d5a2923fdc51ed95c47d0f76ddf4a7bf24daaab5acc8bc740a04dccf64d7d8a190e12931411402b1fe5fbc5cc1572a1ecc042be361606bece87");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig,
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution,
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'nanos_atomicMatch_buyNow_bundle_multiple_unknownToken', [13, 0]);
  await tx;
}));

//https://etherscan.io/tx/0x7fd83996604004bdddc09d89647cc4087ba4879f6f5a60263d29daa9b1552167
// Contract address has been modified for 2nd token to raise 'multiple' screen. (a342 ->a343)
test('[Nano S] nanos_atomicMatch_buyNow_bundle_multiple_unknownToken_warning', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0xf915cb7c85109966c9ef83091fe2947be8076f4ea4a4ad08075c2508e481d6c946d12b80b91564ab834bab0000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000a756ef8e21fc7d0e9097aa41fd3467129eed798d000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c20000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c53a9c309ee2f3e333bd6eca806a31d0e2dca5c50000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c200000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc200000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e4e1c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000612b99ef0000000000000000000000000000000000000000000000000000000000000000d03a608d2402ed6e32a3585c28b55d8c06d957159f8d34a99772dabaa1dd800500000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e4e1c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006116cedc00000000000000000000000000000000000000000000000000000000000000000c7768501b78545bc74f553f49e5d8e8598a3874c35cf7618a212116791579170000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000006a00000000000000000000000000000000000000000000000000000000000000a400000000000000000000000000000000000000000000000000000000000000de0000000000000000000000000000000000000000000000000000000000000118000000000000000000000000000000000000000000000000000000000000015200000000000000000000000000000000000000000000000000000000000001540000000000000000000000000000000000000000000000000000000000000001b000000000000000000000000000000000000000000000000000000000000001bbc49b7add62873b9fd9cf7c666121f35b33ca5b593c89a9731d7fafea99210511ceee2d8981910b0f1daa7a76fad0c75edfee7f51e4ac7bca69103b72ad01956bc49b7add62873b9fd9cf7c666121f35b33ca5b593c89a9731d7fafea99210511ceee2d8981910b0f1daa7a76fad0c75edfee7f51e4ac7bca69103b72ad019560000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000036468f0bcaa000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000002000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000a343f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c40000000000000000000000000000000000000000000000000000000000000188f242432a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a756ef8e21fc7d0e9097aa41fd3467129eed798d67e1ab582fd4744c04a817593a089e82129bc18c000000000000000000801800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a756ef8e21fc7d0e9097aa41fd3467129eed798d7a9fe22691c811ea339d9b73150e6911a5343dca000000000000000007000800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000036468f0bcaa000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000002000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c40000000000000000000000000000000000000000000000000000000000000188f242432a000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c2000000000000000000000000000000000000000000000000000000000000000067e1ab582fd4744c04a817593a089e82129bc18c000000000000000000801800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c200000000000000000000000000000000000000000000000000000000000000007a9fe22691c811ea339d9b73150e6911a5343dca000000000000000007000800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000364000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003640000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000025a0ce12b41ada2bf52d5a2923fdc51ed95c47d0f76ddf4a7bf24daaab5acc8bc740a04dccf64d7d8a190e12931411402b1fe5fbc5cc1572a1ecc042be361606bece87");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig,
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'nanos_atomicMatch_buyNow_bundle_multiple_unknownToken_warning', [15, 0]);
  await tx;
}));

//https://etherscan.io/tx/0x7fd83996604004bdddc09d89647cc4087ba4879f6f5a60263d29daa9b1552167
// but payment token c53a9c309ee2f3e333bd6eca806a31d0e2dca5c5 has been replaced to WETH and 'buy-maker' address has been modified to match ledger's (0xa756ef8e21fc7d0e9097aa41fd3467129eed798d -> 0xfe984369ce3919aa7bb4f431082d027b4f8ed70c).
test('[Nano S] nanos_atomicMatch_buyNow_bundle_nftAddress_weth', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0xf915cb7c85109966c9ef83091fe2947be8076f4ea4a4ad08075c2508e481d6c946d12b80b91564ab834bab0000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000fe984369ce3919aa7bb4f431082d027b4f8ed70c000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c20000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc20000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c200000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc200000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e4e1c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000612b99ef0000000000000000000000000000000000000000000000000000000000000000d03a608d2402ed6e32a3585c28b55d8c06d957159f8d34a99772dabaa1dd800500000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e4e1c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006116cedc00000000000000000000000000000000000000000000000000000000000000000c7768501b78545bc74f553f49e5d8e8598a3874c35cf7618a212116791579170000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000006a00000000000000000000000000000000000000000000000000000000000000a400000000000000000000000000000000000000000000000000000000000000de0000000000000000000000000000000000000000000000000000000000000118000000000000000000000000000000000000000000000000000000000000015200000000000000000000000000000000000000000000000000000000000001540000000000000000000000000000000000000000000000000000000000000001b000000000000000000000000000000000000000000000000000000000000001bbc49b7add62873b9fd9cf7c666121f35b33ca5b593c89a9731d7fafea99210511ceee2d8981910b0f1daa7a76fad0c75edfee7f51e4ac7bca69103b72ad01956bc49b7add62873b9fd9cf7c666121f35b33ca5b593c89a9731d7fafea99210511ceee2d8981910b0f1daa7a76fad0c75edfee7f51e4ac7bca69103b72ad019560000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000036468f0bcaa000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000002000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c40000000000000000000000000000000000000000000000000000000000000188f242432a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000fe984369ce3919aa7bb4f431082d027b4f8ed70c67e1ab582fd4744c04a817593a089e82129bc18c000000000000000000801800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000fe984369ce3919aa7bb4f431082d027b4f8ed70c7a9fe22691c811ea339d9b73150e6911a5343dca000000000000000007000800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000036468f0bcaa000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000002000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c40000000000000000000000000000000000000000000000000000000000000188f242432a000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c2000000000000000000000000000000000000000000000000000000000000000067e1ab582fd4744c04a817593a089e82129bc18c000000000000000000801800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c200000000000000000000000000000000000000000000000000000000000000007a9fe22691c811ea339d9b73150e6911a5343dca000000000000000007000800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000364000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003640000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000025a0ce12b41ada2bf52d5a2923fdc51ed95c47d0f76ddf4a7bf24daaab5acc8bc740a04dccf64d7d8a190e12931411402b1fe5fbc5cc1572a1ecc042be361606bece87");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig,
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution,
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'nanos_atomicMatch_buyNow_bundle_nftAddress_weth', [12, 0]);
  await tx;
}));

//https://etherscan.io/tx/0x7fd83996604004bdddc09d89647cc4087ba4879f6f5a60263d29daa9b1552167
// but payment token c53a9c309ee2f3e333bd6eca806a31d0e2dca5c5 has been replaced to WETH and 'buy-maker' address does not match ledger address.
test('[Nano S] nanos_atomicMatch_buyNow_bundle_nftAddress_weth_warning', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0xf915cb7c85109966c9ef83091fe2947be8076f4ea4a4ad08075c2508e481d6c946d12b80b91564ab834bab0000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000a756ef8e21fc7d0e9097aa41fd3467129eed798d000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c20000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc20000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c200000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc200000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e4e1c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000612b99ef0000000000000000000000000000000000000000000000000000000000000000d03a608d2402ed6e32a3585c28b55d8c06d957159f8d34a99772dabaa1dd800500000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e4e1c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006116cedc00000000000000000000000000000000000000000000000000000000000000000c7768501b78545bc74f553f49e5d8e8598a3874c35cf7618a212116791579170000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000006a00000000000000000000000000000000000000000000000000000000000000a400000000000000000000000000000000000000000000000000000000000000de0000000000000000000000000000000000000000000000000000000000000118000000000000000000000000000000000000000000000000000000000000015200000000000000000000000000000000000000000000000000000000000001540000000000000000000000000000000000000000000000000000000000000001b000000000000000000000000000000000000000000000000000000000000001bbc49b7add62873b9fd9cf7c666121f35b33ca5b593c89a9731d7fafea99210511ceee2d8981910b0f1daa7a76fad0c75edfee7f51e4ac7bca69103b72ad01956bc49b7add62873b9fd9cf7c666121f35b33ca5b593c89a9731d7fafea99210511ceee2d8981910b0f1daa7a76fad0c75edfee7f51e4ac7bca69103b72ad019560000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000036468f0bcaa000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000002000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c40000000000000000000000000000000000000000000000000000000000000188f242432a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a756ef8e21fc7d0e9097aa41fd3467129eed798d67e1ab582fd4744c04a817593a089e82129bc18c000000000000000000801800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a756ef8e21fc7d0e9097aa41fd3467129eed798d7a9fe22691c811ea339d9b73150e6911a5343dca000000000000000007000800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000036468f0bcaa000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000002000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c40000000000000000000000000000000000000000000000000000000000000188f242432a000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c2000000000000000000000000000000000000000000000000000000000000000067e1ab582fd4744c04a817593a089e82129bc18c000000000000000000801800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c200000000000000000000000000000000000000000000000000000000000000007a9fe22691c811ea339d9b73150e6911a5343dca000000000000000007000800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000364000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003640000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000025a0ce12b41ada2bf52d5a2923fdc51ed95c47d0f76ddf4a7bf24daaab5acc8bc740a04dccf64d7d8a190e12931411402b1fe5fbc5cc1572a1ecc042be361606bece87");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig,
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution,
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'nanos_atomicMatch_buyNow_bundle_nftAddress_weth_warning', [14, 0]);
  await tx;
}));

//https://etherscan.io/tx/0x7fd83996604004bdddc09d89647cc4087ba4879f6f5a60263d29daa9b1552167
// but payment token c53a9c309ee2f3e333bd6eca806a31d0e2dca5c5 has been replaced to WETH and 'buy-maker' address has been modified to match ledger's (0xa756ef8e21fc7d0e9097aa41fd3467129eed798d -> 0xfe984369ce3919aa7bb4f431082d027b4f8ed70c). Also, sell-side transfer method has been modified to raise unknown_method ui (68f0 -> 68f1)
test('[Nano S] nanos_atomicMatch_buyNow_unknownMethod_nftAddress_weth', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0xf915cb7c85109966c9ef83091fe2947be8076f4ea4a4ad08075c2508e481d6c946d12b80b91564ab834bab0000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000fe984369ce3919aa7bb4f431082d027b4f8ed70c000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c20000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc20000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c200000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc200000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e4e1c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000612b99ef0000000000000000000000000000000000000000000000000000000000000000d03a608d2402ed6e32a3585c28b55d8c06d957159f8d34a99772dabaa1dd800500000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e4e1c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006116cedc00000000000000000000000000000000000000000000000000000000000000000c7768501b78545bc74f553f49e5d8e8598a3874c35cf7618a212116791579170000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000006a00000000000000000000000000000000000000000000000000000000000000a400000000000000000000000000000000000000000000000000000000000000de0000000000000000000000000000000000000000000000000000000000000118000000000000000000000000000000000000000000000000000000000000015200000000000000000000000000000000000000000000000000000000000001540000000000000000000000000000000000000000000000000000000000000001b000000000000000000000000000000000000000000000000000000000000001bbc49b7add62873b9fd9cf7c666121f35b33ca5b593c89a9731d7fafea99210511ceee2d8981910b0f1daa7a76fad0c75edfee7f51e4ac7bca69103b72ad01956bc49b7add62873b9fd9cf7c666121f35b33ca5b593c89a9731d7fafea99210511ceee2d8981910b0f1daa7a76fad0c75edfee7f51e4ac7bca69103b72ad019560000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000036468f0bcaa000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000002000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c40000000000000000000000000000000000000000000000000000000000000188f242432a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000fe984369ce3919aa7bb4f431082d027b4f8ed70c67e1ab582fd4744c04a817593a089e82129bc18c000000000000000000801800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000fe984369ce3919aa7bb4f431082d027b4f8ed70c7a9fe22691c811ea339d9b73150e6911a5343dca000000000000000007000800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000036468f1bcaa000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000002000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c40000000000000000000000000000000000000000000000000000000000000188f242432a000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c2000000000000000000000000000000000000000000000000000000000000000067e1ab582fd4744c04a817593a089e82129bc18c000000000000000000801800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c200000000000000000000000000000000000000000000000000000000000000007a9fe22691c811ea339d9b73150e6911a5343dca000000000000000007000800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000364000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003640000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000025a0ce12b41ada2bf52d5a2923fdc51ed95c47d0f76ddf4a7bf24daaab5acc8bc740a04dccf64d7d8a190e12931411402b1fe5fbc5cc1572a1ecc042be361606bece87");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig,
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution,
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'nanos_atomicMatch_buyNow_unknownMethod_nftAddress_weth', [13, 0]);
  await tx;
}));

//https://etherscan.io/tx/0x7fd83996604004bdddc09d89647cc4087ba4879f6f5a60263d29daa9b1552167
// but payment token c53a9c309ee2f3e333bd6eca806a31d0e2dca5c5 has been replaced to WETH. Also, sell-side transfer method has been modified to raise unknown_method ui (68f0 -> 68f1)
test('[Nano S] nanos_atomicMatch_buyNow_unknownMethod_nftAddress_weth_warning', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0xf915cb7c85109966c9ef83091fe2947be8076f4ea4a4ad08075c2508e481d6c946d12b80b91564ab834bab0000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000a756ef8e21fc7d0e9097aa41fd3467129eed798d000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c20000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc20000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c200000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc200000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e4e1c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000612b99ef0000000000000000000000000000000000000000000000000000000000000000d03a608d2402ed6e32a3585c28b55d8c06d957159f8d34a99772dabaa1dd800500000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e4e1c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006116cedc00000000000000000000000000000000000000000000000000000000000000000c7768501b78545bc74f553f49e5d8e8598a3874c35cf7618a212116791579170000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000006a00000000000000000000000000000000000000000000000000000000000000a400000000000000000000000000000000000000000000000000000000000000de0000000000000000000000000000000000000000000000000000000000000118000000000000000000000000000000000000000000000000000000000000015200000000000000000000000000000000000000000000000000000000000001540000000000000000000000000000000000000000000000000000000000000001b000000000000000000000000000000000000000000000000000000000000001bbc49b7add62873b9fd9cf7c666121f35b33ca5b593c89a9731d7fafea99210511ceee2d8981910b0f1daa7a76fad0c75edfee7f51e4ac7bca69103b72ad01956bc49b7add62873b9fd9cf7c666121f35b33ca5b593c89a9731d7fafea99210511ceee2d8981910b0f1daa7a76fad0c75edfee7f51e4ac7bca69103b72ad019560000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000036468f0bcaa000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000002000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c40000000000000000000000000000000000000000000000000000000000000188f242432a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a756ef8e21fc7d0e9097aa41fd3467129eed798d67e1ab582fd4744c04a817593a089e82129bc18c000000000000000000801800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a756ef8e21fc7d0e9097aa41fd3467129eed798d7a9fe22691c811ea339d9b73150e6911a5343dca000000000000000007000800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000036468f1bcaa000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000002000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c40000000000000000000000000000000000000000000000000000000000000188f242432a000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c2000000000000000000000000000000000000000000000000000000000000000067e1ab582fd4744c04a817593a089e82129bc18c000000000000000000801800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c200000000000000000000000000000000000000000000000000000000000000007a9fe22691c811ea339d9b73150e6911a5343dca000000000000000007000800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000364000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003640000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000025a0ce12b41ada2bf52d5a2923fdc51ed95c47d0f76ddf4a7bf24daaab5acc8bc740a04dccf64d7d8a190e12931411402b1fe5fbc5cc1572a1ecc042be361606bece87");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig,
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution,
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'nanos_atomicMatch_buyNow_unknownMethod_nftAddress_weth_warning', [15, 0]);
  await tx;
}));

//https://etherscan.io/tx/0x7fd83996604004bdddc09d89647cc4087ba4879f6f5a60263d29daa9b1552167
// but payment token c53a9c309ee2f3e333bd6eca806a31d0e2dca5c5 has been replaced to WETH and 'buy-maker' address has been modified to match ledger's (0xa756ef8e21fc7d0e9097aa41fd3467129eed798d -> 0xfe984369ce3919aa7bb4f431082d027b4f8ed70c). Also, sell-side transfer method has been modified to raise unknown_method ui (68f0 -> 68f1)and nft_contract address has been modified to raise 'multiple' ui. (a342 -> a343)
test('[Nano S] nanos_atomicMatch_buyNow_unknownMethod_multiple_weth', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0xf915cb7c85109966c9ef83091fe2947be8076f4ea4a4ad08075c2508e481d6c946d12b80b91564ab834bab0000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000fe984369ce3919aa7bb4f431082d027b4f8ed70c000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c20000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc20000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c200000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc200000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e4e1c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000612b99ef0000000000000000000000000000000000000000000000000000000000000000d03a608d2402ed6e32a3585c28b55d8c06d957159f8d34a99772dabaa1dd800500000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e4e1c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006116cedc00000000000000000000000000000000000000000000000000000000000000000c7768501b78545bc74f553f49e5d8e8598a3874c35cf7618a212116791579170000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000006a00000000000000000000000000000000000000000000000000000000000000a400000000000000000000000000000000000000000000000000000000000000de0000000000000000000000000000000000000000000000000000000000000118000000000000000000000000000000000000000000000000000000000000015200000000000000000000000000000000000000000000000000000000000001540000000000000000000000000000000000000000000000000000000000000001b000000000000000000000000000000000000000000000000000000000000001bbc49b7add62873b9fd9cf7c666121f35b33ca5b593c89a9731d7fafea99210511ceee2d8981910b0f1daa7a76fad0c75edfee7f51e4ac7bca69103b72ad01956bc49b7add62873b9fd9cf7c666121f35b33ca5b593c89a9731d7fafea99210511ceee2d8981910b0f1daa7a76fad0c75edfee7f51e4ac7bca69103b72ad019560000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000036468f0bcaa000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000002000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000a343f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c40000000000000000000000000000000000000000000000000000000000000188f242432a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a756ef8e21fc7d0e9097aa41fd3467129eed798d67e1ab582fd4744c04a817593a089e82129bc18c000000000000000000801800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a756ef8e21fc7d0e9097aa41fd3467129eed798d7a9fe22691c811ea339d9b73150e6911a5343dca000000000000000007000800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000036468f1bcaa000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000002000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c40000000000000000000000000000000000000000000000000000000000000188f242432a000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c2000000000000000000000000000000000000000000000000000000000000000067e1ab582fd4744c04a817593a089e82129bc18c000000000000000000801800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c200000000000000000000000000000000000000000000000000000000000000007a9fe22691c811ea339d9b73150e6911a5343dca000000000000000007000800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000364000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003640000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000025a0ce12b41ada2bf52d5a2923fdc51ed95c47d0f76ddf4a7bf24daaab5acc8bc740a04dccf64d7d8a190e12931411402b1fe5fbc5cc1572a1ecc042be361606bece87");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig,
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution,
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'nanos_atomicMatch_buyNow_unknownMethod_multiple_weth', [11, 0]);
  await tx;
}));

//https://etherscan.io/tx/0x7fd83996604004bdddc09d89647cc4087ba4879f6f5a60263d29daa9b1552167
// 'buy-maker' address has been modified to match ledger's (0xa756ef8e21fc7d0e9097aa41fd3467129eed798d -> 0xfe984369ce3919aa7bb4f431082d027b4f8ed70c). Also, sell-side transfer method has been modified to raise 'unknown_method' ui (68f0 -> 68f1)and nft_contract address has been modified to raise 'multiple' ui. (a342 -> a343)
test('[Nano S] nanos_atomicMatch_buyNow_unknownMethod_multiple_unknownToken', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0xf915cb7c85109966c9ef83091fe2947be8076f4ea4a4ad08075c2508e481d6c946d12b80b91564ab834bab0000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000fe984369ce3919aa7bb4f431082d027b4f8ed70c000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c20000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c53a9c309ee2f3e333bd6eca806a31d0e2dca5c50000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c200000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc200000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e4e1c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000612b99ef0000000000000000000000000000000000000000000000000000000000000000d03a608d2402ed6e32a3585c28b55d8c06d957159f8d34a99772dabaa1dd800500000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e4e1c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006116cedc00000000000000000000000000000000000000000000000000000000000000000c7768501b78545bc74f553f49e5d8e8598a3874c35cf7618a212116791579170000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000006a00000000000000000000000000000000000000000000000000000000000000a400000000000000000000000000000000000000000000000000000000000000de0000000000000000000000000000000000000000000000000000000000000118000000000000000000000000000000000000000000000000000000000000015200000000000000000000000000000000000000000000000000000000000001540000000000000000000000000000000000000000000000000000000000000001b000000000000000000000000000000000000000000000000000000000000001bbc49b7add62873b9fd9cf7c666121f35b33ca5b593c89a9731d7fafea99210511ceee2d8981910b0f1daa7a76fad0c75edfee7f51e4ac7bca69103b72ad01956bc49b7add62873b9fd9cf7c666121f35b33ca5b593c89a9731d7fafea99210511ceee2d8981910b0f1daa7a76fad0c75edfee7f51e4ac7bca69103b72ad019560000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000036468f0bcaa000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000002000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000a343f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c40000000000000000000000000000000000000000000000000000000000000188f242432a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a756ef8e21fc7d0e9097aa41fd3467129eed798d67e1ab582fd4744c04a817593a089e82129bc18c000000000000000000801800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a756ef8e21fc7d0e9097aa41fd3467129eed798d7a9fe22691c811ea339d9b73150e6911a5343dca000000000000000007000800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000036468f1bcaa000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000002000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c40000000000000000000000000000000000000000000000000000000000000188f242432a000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c2000000000000000000000000000000000000000000000000000000000000000067e1ab582fd4744c04a817593a089e82129bc18c000000000000000000801800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c200000000000000000000000000000000000000000000000000000000000000007a9fe22691c811ea339d9b73150e6911a5343dca000000000000000007000800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000364000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003640000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000025a0ce12b41ada2bf52d5a2923fdc51ed95c47d0f76ddf4a7bf24daaab5acc8bc740a04dccf64d7d8a190e12931411402b1fe5fbc5cc1572a1ecc042be361606bece87");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig,
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution,
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'nanos_atomicMatch_buyNow_unknownMethod_multiple_unknownToken', [14, 0]);
  await tx;
}));

//https://etherscan.io/tx/0x7fd83996604004bdddc09d89647cc4087ba4879f6f5a60263d29daa9b1552167
// 'buy-maker' address does not match ledger's to raise 'beneficiary warning' ui, sell-side transfer method has been modified to raise 'unknown_method' ui (68f0 -> 68f1)and nft_contract address has been modified to raise 'multiple' ui. (a342 -> a343)
test('[Nano S] nanos_atomicMatch_buyNow_unknownMethod_multiple_unknownToken_warning', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0xf915cb7c85109966c9ef83091fe2947be8076f4ea4a4ad08075c2508e481d6c946d12b80b91564ab834bab0000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000a756ef8e21fc7d0e9097aa41fd3467129eed798d000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c20000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c53a9c309ee2f3e333bd6eca806a31d0e2dca5c50000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c200000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc200000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e4e1c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000612b99ef0000000000000000000000000000000000000000000000000000000000000000d03a608d2402ed6e32a3585c28b55d8c06d957159f8d34a99772dabaa1dd800500000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e4e1c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006116cedc00000000000000000000000000000000000000000000000000000000000000000c7768501b78545bc74f553f49e5d8e8598a3874c35cf7618a212116791579170000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000006a00000000000000000000000000000000000000000000000000000000000000a400000000000000000000000000000000000000000000000000000000000000de0000000000000000000000000000000000000000000000000000000000000118000000000000000000000000000000000000000000000000000000000000015200000000000000000000000000000000000000000000000000000000000001540000000000000000000000000000000000000000000000000000000000000001b000000000000000000000000000000000000000000000000000000000000001bbc49b7add62873b9fd9cf7c666121f35b33ca5b593c89a9731d7fafea99210511ceee2d8981910b0f1daa7a76fad0c75edfee7f51e4ac7bca69103b72ad01956bc49b7add62873b9fd9cf7c666121f35b33ca5b593c89a9731d7fafea99210511ceee2d8981910b0f1daa7a76fad0c75edfee7f51e4ac7bca69103b72ad019560000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000036468f0bcaa000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000002000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000a343f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c40000000000000000000000000000000000000000000000000000000000000188f242432a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a756ef8e21fc7d0e9097aa41fd3467129eed798d67e1ab582fd4744c04a817593a089e82129bc18c000000000000000000801800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a756ef8e21fc7d0e9097aa41fd3467129eed798d7a9fe22691c811ea339d9b73150e6911a5343dca000000000000000007000800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000036468f1bcaa000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000002000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c40000000000000000000000000000000000000000000000000000000000000188f242432a000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c2000000000000000000000000000000000000000000000000000000000000000067e1ab582fd4744c04a817593a089e82129bc18c000000000000000000801800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c200000000000000000000000000000000000000000000000000000000000000007a9fe22691c811ea339d9b73150e6911a5343dca000000000000000007000800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000364000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003640000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000025a0ce12b41ada2bf52d5a2923fdc51ed95c47d0f76ddf4a7bf24daaab5acc8bc740a04dccf64d7d8a190e12931411402b1fe5fbc5cc1572a1ecc042be361606bece87");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig,
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution,
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'nanos_atomicMatch_buyNow_unknownMethod_multiple_unknownToken_warning', [16, 0]);
  await tx;
}));

//https://etherscan.io/tx/0x7fd83996604004bdddc09d89647cc4087ba4879f6f5a60263d29daa9b1552167
// Also, sell-side transfer method has been modified to raise unknown_method ui (68f0 -> 68f1)
test('[Nano S] nanos_atomicMatch_buyNow_unknownMethod_nftAddress_unknownToken_warning', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0xf915cb7c85109966c9ef83091fe2947be8076f4ea4a4ad08075c2508e481d6c946d12b80b91564ab834bab0000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000a756ef8e21fc7d0e9097aa41fd3467129eed798d000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c20000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c53a9c309ee2f3e333bd6eca806a31d0e2dca5c50000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c200000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc200000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e4e1c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000612b99ef0000000000000000000000000000000000000000000000000000000000000000d03a608d2402ed6e32a3585c28b55d8c06d957159f8d34a99772dabaa1dd800500000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e4e1c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006116cedc00000000000000000000000000000000000000000000000000000000000000000c7768501b78545bc74f553f49e5d8e8598a3874c35cf7618a212116791579170000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000006a00000000000000000000000000000000000000000000000000000000000000a400000000000000000000000000000000000000000000000000000000000000de0000000000000000000000000000000000000000000000000000000000000118000000000000000000000000000000000000000000000000000000000000015200000000000000000000000000000000000000000000000000000000000001540000000000000000000000000000000000000000000000000000000000000001b000000000000000000000000000000000000000000000000000000000000001bbc49b7add62873b9fd9cf7c666121f35b33ca5b593c89a9731d7fafea99210511ceee2d8981910b0f1daa7a76fad0c75edfee7f51e4ac7bca69103b72ad01956bc49b7add62873b9fd9cf7c666121f35b33ca5b593c89a9731d7fafea99210511ceee2d8981910b0f1daa7a76fad0c75edfee7f51e4ac7bca69103b72ad019560000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000036468f0bcaa000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000002000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c40000000000000000000000000000000000000000000000000000000000000188f242432a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a756ef8e21fc7d0e9097aa41fd3467129eed798d67e1ab582fd4744c04a817593a089e82129bc18c000000000000000000801800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a756ef8e21fc7d0e9097aa41fd3467129eed798d7a9fe22691c811ea339d9b73150e6911a5343dca000000000000000007000800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000036468f1bcaa000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000002000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c40000000000000000000000000000000000000000000000000000000000000188f242432a000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c2000000000000000000000000000000000000000000000000000000000000000067e1ab582fd4744c04a817593a089e82129bc18c000000000000000000801800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c200000000000000000000000000000000000000000000000000000000000000007a9fe22691c811ea339d9b73150e6911a5343dca000000000000000007000800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000364000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003640000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000025a0ce12b41ada2bf52d5a2923fdc51ed95c47d0f76ddf4a7bf24daaab5acc8bc740a04dccf64d7d8a190e12931411402b1fe5fbc5cc1572a1ecc042be361606bece87");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig,
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution,
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'nanos_atomicMatch_buyNow_unknownMethod_nftAddress_unknownToken_warning', [18, 0]);
  await tx;
}));

//https://etherscan.io/tx/0x7fd83996604004bdddc09d89647cc4087ba4879f6f5a60263d29daa9b1552167
// But token address is "unknown" and raises unknown_token warning and 'buy-maker' does not match ledger address to raise beneficiary warning.
test('[Nano S] nanos_atomicMatch_buyNow_bundle_nftAddress_unknownToken_warning', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0xf915cb7c85109966c9ef83091fe2947be8076f4ea4a4ad08075c2508e481d6c946d12b80b91564ab834bab0000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000a756ef8e21fc7d0e9097aa41fd3467129eed798d000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c20000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c53a9c309ee2f3e333bd6eca806a31d0e2dca5c50000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c200000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c53a9c309ee2f3e333bd6eca806a31d0e2dca5c500000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e4e1c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000612b99ef0000000000000000000000000000000000000000000000000000000000000000d03a608d2402ed6e32a3585c28b55d8c06d957159f8d34a99772dabaa1dd800500000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e4e1c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006116cedc00000000000000000000000000000000000000000000000000000000000000000c7768501b78545bc74f553f49e5d8e8598a3874c35cf7618a212116791579170000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000006a00000000000000000000000000000000000000000000000000000000000000a400000000000000000000000000000000000000000000000000000000000000de0000000000000000000000000000000000000000000000000000000000000118000000000000000000000000000000000000000000000000000000000000015200000000000000000000000000000000000000000000000000000000000001540000000000000000000000000000000000000000000000000000000000000001b000000000000000000000000000000000000000000000000000000000000001bbc49b7add62873b9fd9cf7c666121f35b33ca5b593c89a9731d7fafea99210511ceee2d8981910b0f1daa7a76fad0c75edfee7f51e4ac7bca69103b72ad01956bc49b7add62873b9fd9cf7c666121f35b33ca5b593c89a9731d7fafea99210511ceee2d8981910b0f1daa7a76fad0c75edfee7f51e4ac7bca69103b72ad019560000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000036468f0bcaa000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000002000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c40000000000000000000000000000000000000000000000000000000000000188f242432a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a756ef8e21fc7d0e9097aa41fd3467129eed798d67e1ab582fd4744c04a817593a089e82129bc18c000000000000000000801800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a756ef8e21fc7d0e9097aa41fd3467129eed798d7a9fe22691c811ea339d9b73150e6911a5343dca000000000000000007000800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000036468f0bcaa000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000002000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c40000000000000000000000000000000000000000000000000000000000000188f242432a000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c2000000000000000000000000000000000000000000000000000000000000000067e1ab582fd4744c04a817593a089e82129bc18c000000000000000000801800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c200000000000000000000000000000000000000000000000000000000000000007a9fe22691c811ea339d9b73150e6911a5343dca000000000000000007000800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000364000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003640000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000025a0ce12b41ada2bf52d5a2923fdc51ed95c47d0f76ddf4a7bf24daaab5acc8bc740a04dccf64d7d8a190e12931411402b1fe5fbc5cc1572a1ecc042be361606bece87");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig,
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution,
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'nanos_atomicMatch_buyNow_bundle_nftAddress_unknownToken_warning', [17, 0]);
  await tx;
}));

//https://etherscan.io/tx/0x7fd83996604004bdddc09d89647cc4087ba4879f6f5a60263d29daa9b1552167
// but 'maker-buy' address modified to match ledger (0xa756ef8e21fc7d0e9097aa41fd3467129eed798d -> 0xfe984369ce3919aa7bb4f431082d027b4f8ed70c)
test('[Nano S] nanos_atomicMatch_buyNow_bundle_nftAddress_unknownToken', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0xf915cb7c85109966c9ef83091fe2947be8076f4ea4a4ad08075c2508e481d6c946d12b80b91564ab834bab0000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000fe984369ce3919aa7bb4f431082d027b4f8ed70c000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c20000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c53a9c309ee2f3e333bd6eca806a31d0e2dca5c50000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c200000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c53a9c309ee2f3e333bd6eca806a31d0e2dca5c500000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e4e1c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000612b99ef0000000000000000000000000000000000000000000000000000000000000000d03a608d2402ed6e32a3585c28b55d8c06d957159f8d34a99772dabaa1dd800500000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e4e1c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006116cedc00000000000000000000000000000000000000000000000000000000000000000c7768501b78545bc74f553f49e5d8e8598a3874c35cf7618a212116791579170000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000006a00000000000000000000000000000000000000000000000000000000000000a400000000000000000000000000000000000000000000000000000000000000de0000000000000000000000000000000000000000000000000000000000000118000000000000000000000000000000000000000000000000000000000000015200000000000000000000000000000000000000000000000000000000000001540000000000000000000000000000000000000000000000000000000000000001b000000000000000000000000000000000000000000000000000000000000001bbc49b7add62873b9fd9cf7c666121f35b33ca5b593c89a9731d7fafea99210511ceee2d8981910b0f1daa7a76fad0c75edfee7f51e4ac7bca69103b72ad01956bc49b7add62873b9fd9cf7c666121f35b33ca5b593c89a9731d7fafea99210511ceee2d8981910b0f1daa7a76fad0c75edfee7f51e4ac7bca69103b72ad019560000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000036468f0bcaa000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000002000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c40000000000000000000000000000000000000000000000000000000000000188f242432a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000fe984369ce3919aa7bb4f431082d027b4f8ed70c67e1ab582fd4744c04a817593a089e82129bc18c000000000000000000801800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000fe984369ce3919aa7bb4f431082d027b4f8ed70c7a9fe22691c811ea339d9b73150e6911a5343dca000000000000000007000800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000036468f0bcaa000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000002000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c40000000000000000000000000000000000000000000000000000000000000188f242432a000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c2000000000000000000000000000000000000000000000000000000000000000067e1ab582fd4744c04a817593a089e82129bc18c000000000000000000801800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c200000000000000000000000000000000000000000000000000000000000000007a9fe22691c811ea339d9b73150e6911a5343dca000000000000000007000800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000364000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003640000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000025a0ce12b41ada2bf52d5a2923fdc51ed95c47d0f76ddf4a7bf24daaab5acc8bc740a04dccf64d7d8a190e12931411402b1fe5fbc5cc1572a1ecc042be361606bece87");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig,
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution,
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'nanos_atomicMatch_buyNow_bundle_nftAddress_unknownToken', [15, 0]);
  await tx;
}));

//https://etherscan.io/tx/0x7fd83996604004bdddc09d89647cc4087ba4879f6f5a60263d29daa9b1552167
// But token address is "unknown" and raises unknown_token warning and 'buy-maker' does not match ledger address to raise beneficiary warning.
test('[Nano S] nanos_atomicMatch_buyNow_bundle_nftAddress_unknownToken_warning', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0xf915cb7c85109966c9ef83091fe2947be8076f4ea4a4ad08075c2508e481d6c946d12b80b91564ab834bab0000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000a756ef8e21fc7d0e9097aa41fd3467129eed798d000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c20000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c53a9c309ee2f3e333bd6eca806a31d0e2dca5c50000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c200000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c53a9c309ee2f3e333bd6eca806a31d0e2dca5c500000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e4e1c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000612b99ef0000000000000000000000000000000000000000000000000000000000000000d03a608d2402ed6e32a3585c28b55d8c06d957159f8d34a99772dabaa1dd800500000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e4e1c00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006116cedc00000000000000000000000000000000000000000000000000000000000000000c7768501b78545bc74f553f49e5d8e8598a3874c35cf7618a212116791579170000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000006a00000000000000000000000000000000000000000000000000000000000000a400000000000000000000000000000000000000000000000000000000000000de0000000000000000000000000000000000000000000000000000000000000118000000000000000000000000000000000000000000000000000000000000015200000000000000000000000000000000000000000000000000000000000001540000000000000000000000000000000000000000000000000000000000000001b000000000000000000000000000000000000000000000000000000000000001bbc49b7add62873b9fd9cf7c666121f35b33ca5b593c89a9731d7fafea99210511ceee2d8981910b0f1daa7a76fad0c75edfee7f51e4ac7bca69103b72ad01956bc49b7add62873b9fd9cf7c666121f35b33ca5b593c89a9731d7fafea99210511ceee2d8981910b0f1daa7a76fad0c75edfee7f51e4ac7bca69103b72ad019560000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000036468f0bcaa000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000002000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c40000000000000000000000000000000000000000000000000000000000000188f242432a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a756ef8e21fc7d0e9097aa41fd3467129eed798d67e1ab582fd4744c04a817593a089e82129bc18c000000000000000000801800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000a756ef8e21fc7d0e9097aa41fd3467129eed798d7a9fe22691c811ea339d9b73150e6911a5343dca000000000000000007000800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000036468f0bcaa000000000000000000000000000000000000000000000000000000000000008000000000000000000000000000000000000000000000000000000000000000e0000000000000000000000000000000000000000000000000000000000000014000000000000000000000000000000000000000000000000000000000000001a00000000000000000000000000000000000000000000000000000000000000002000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000a342f5d851e866e18ff98f351f2c6637f4478db5000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000200000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c40000000000000000000000000000000000000000000000000000000000000188f242432a000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c2000000000000000000000000000000000000000000000000000000000000000067e1ab582fd4744c04a817593a089e82129bc18c000000000000000000801800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a000000000000000000000000d82201e0373ade24b30f86c1d8f2a446cb51d3c200000000000000000000000000000000000000000000000000000000000000007a9fe22691c811ea339d9b73150e6911a5343dca000000000000000007000800000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000364000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003640000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000025a0ce12b41ada2bf52d5a2923fdc51ed95c47d0f76ddf4a7bf24daaab5acc8bc740a04dccf64d7d8a190e12931411402b1fe5fbc5cc1572a1ecc042be361606bece87");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution,
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'nanos_atomicMatch_buyNow_bundle_nftAddress_unknownToken_warning', [17, 0]);
  await tx;
}));

//https://etherscan.io/tx/0xe9c93c71a62ba3e1fb3403f336d7d62155d06446b1aa5a5a7561b6b1235c5f2e
// but 'maker-buy' address modified to match ledger (0x502257814d3d964e7f42f03f7dcad83cbda31819 -> 0xfe984369ce3919aa7bb4f431082d027b4f8ed70c)
test('[Nano S] pudgy_pinguins', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0x02f909db01238501211520808513ce586e6d8303bbb6947be8076f4ea4a4ad08075c2508e481d6c946d12b881b9de674df070000b90964ab834bab0000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000fe984369ce3919aa7bb4f431082d027b4f8ed70c0000000000000000000000009bf0012a8e8d2773c3df612aece2c6da1bafd4890000000000000000000000000000000000000000000000000000000000000000000000000000000000000000bd3531da5cf5857e7cfaa92426877b022e612cf8000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b0000000000000000000000009bf0012a8e8d2773c3df612aece2c6da1bafd48900000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000bd3531da5cf5857e7cfaa92426877b022e612cf80000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002260000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001b9de674df070000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000611a7d240000000000000000000000000000000000000000000000000000000000000000bfee0f6bb7ecfdeee2d41eae1b9fdf0bf58f9bf1c10711177a684f6c18d1c99100000000000000000000000000000000000000000000000000000000000002260000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001b9de674df070000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000611a7c6500000000000000000000000000000000000000000000000000000000611a7e9cc5cd362f629c7172f5bf40b859bb83d1925a17e1c80e7a4b1a5866d152ace0e90000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006a0000000000000000000000000000000000000000000000000000000000000074000000000000000000000000000000000000000000000000000000000000007e0000000000000000000000000000000000000000000000000000000000000088000000000000000000000000000000000000000000000000000000000000009200000000000000000000000000000000000000000000000000000000000000940000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000001cc4c94e98739ec4141e8787a662e27f18620f41ff4ef0fda6134975dd92d37b8b35f2776577bdcb597385c07ff45d13db6dfb81aac3a6cd4182f2d6b9c912efa8c4c94e98739ec4141e8787a662e27f18620f41ff4ef0fda6134975dd92d37b8b35f2776577bdcb597385c07ff45d13db6dfb81aac3a6cd4182f2d6b9c912efa80000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006423b872dd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000fe984369ce3919aa7bb4f431082d027b4f8ed70c000000000000000000000000000000000000000000000000000000000000181900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006423b872dd0000000000000000000000009bf0012a8e8d2773c3df612aece2c6da1bafd4890000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000181900000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006400000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c080a019af8b03d273c34710edea48c63c7cd95558d3cdf55640da1268d10cfe846586a074caa383e4e8ad04ab89375ef05667bb884d6e41a0f8d4d19c5229168ccba306");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'pudgy_pinguins', [11, 0]);
  await tx;
}));

//https://etherscan.io/tx/0xf4428462060cc443e9d19a5048ad31dcae46497e1133a0f3016e31c62596067e
test('[Nano S] atomicMatch_nested_good', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0x02f94c590178844430e409850b732cebc98320a0b3947be8076f4ea4a4ad08075c2508e481d6c946d12b87f8b0a10e470000b94be4ab834bab0000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b0000000000000000000000005998feaf62ef1888c5c2df238d0580018888bff90000000000000000000000009a1e3736851633e52c719c7b51c9820641af578a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c5000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b0000000000000000000000009a1e3736851633e52c719c7b51c9820641af578a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003e800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f8b0a10e47000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000061581eba00000000000000000000000000000000000000000000000000000000000000001911971142a502d67d30374066dfdc9c97d8ddb99e96c679f9c737d943df08df00000000000000000000000000000000000000000000000000000000000003e800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f8b0a10e470000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000614f07f100000000000000000000000000000000000000000000000000000000000000007b5d0e30b470c5677447696879c2d1fcdbaac7c71a9d6501a38be05941905a5c0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000006a000000000000000000000000000000000000000000000000000000000000017e000000000000000000000000000000000000000000000000000000000000029200000000000000000000000000000000000000000000000000000000000003a600000000000000000000000000000000000000000000000000000000000004ba00000000000000000000000000000000000000000000000000000000000004bc0000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000001c8344116acfd22bc91561ee6d86c84b1bcbc3530c1da4c7e0ac2c8da7db8ec7933b4c140bba0e9d04e13514117a43891f959a9a8bc2db0a252436b54a8abbaf258344116acfd22bc91561ee6d86c84b1bcbc3530c1da4c7e0ac2c8da7db8ec7933b4c140bba0e9d04e13514117a43891f959a9a8bc2db0a252436b54a8abbaf250000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000110468f0bcaa0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000026000000000000000000000000000000000000000000000000000000000000004400000000000000000000000000000000000000000000000000000000000000620000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c40000000000000000000000000000000000000000000000000000000000000ab8f242432a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005998feaf62ef1888c5c2df238d0580018888bff90000000000000000000000000000000000000000000000000000000000000023000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005998feaf62ef1888c5c2df238d0580018888bff90000000000000000000000000000000000000000000000000000000000000024000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005998feaf62ef1888c5c2df238d0580018888bff90000000000000000000000000000000000000000000000000000000000000025000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005998feaf62ef1888c5c2df238d0580018888bff90000000000000000000000000000000000000000000000000000000000000026000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005998feaf62ef1888c5c2df238d0580018888bff90000000000000000000000000000000000000000000000000000000000000027000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005998feaf62ef1888c5c2df238d0580018888bff90000000000000000000000000000000000000000000000000000000000000028000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005998feaf62ef1888c5c2df238d0580018888bff90000000000000000000000000000000000000000000000000000000000000029000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005998feaf62ef1888c5c2df238d0580018888bff9000000000000000000000000000000000000000000000000000000000000002a000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005998feaf62ef1888c5c2df238d0580018888bff9000000000000000000000000000000000000000000000000000000000000002b000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005998feaf62ef1888c5c2df238d0580018888bff9000000000000000000000000000000000000000000000000000000000000002c000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005998feaf62ef1888c5c2df238d0580018888bff9000000000000000000000000000000000000000000000000000000000000002d000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005998feaf62ef1888c5c2df238d0580018888bff9000000000000000000000000000000000000000000000000000000000000002e000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005998feaf62ef1888c5c2df238d0580018888bff9000000000000000000000000000000000000000000000000000000000000002f000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005998feaf62ef1888c5c2df238d0580018888bff90000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000110468f0bcaa0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000026000000000000000000000000000000000000000000000000000000000000004400000000000000000000000000000000000000000000000000000000000000620000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c40000000000000000000000000000000000000000000000000000000000000ab8f242432a0000000000000000000000009a1e3736851633e52c719c7b51c9820641af578a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000023000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000009a1e3736851633e52c719c7b51c9820641af578a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000024000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000009a1e3736851633e52c719c7b51c9820641af578a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000025000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000009a1e3736851633e52c719c7b51c9820641af578a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000026000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000009a1e3736851633e52c719c7b51c9820641af578a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000027000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000009a1e3736851633e52c719c7b51c9820641af578a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000028000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000009a1e3736851633e52c719c7b51c9820641af578a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000029000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000009a1e3736851633e52c719c7b51c9820641af578a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002a000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000009a1e3736851633e52c719c7b51c9820641af578a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002b000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000009a1e3736851633e52c719c7b51c9820641af578a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002c000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000009a1e3736851633e52c719c7b51c9820641af578a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002d000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000009a1e3736851633e52c719c7b51c9820641af578a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002e000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000009a1e3736851633e52c719c7b51c9820641af578a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002f000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000009a1e3736851633e52c719c7b51c9820641af578a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001104000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c001a0d8e1d593a35b1ddd5d7210f64305553810b81aedded89eae2a67bd4380ba3f2ca0555a282637a1778a4c0122860699370acffc5ddd04790ce0c20779f0e9c069e9");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution,
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'atomicMatch_nested_good', [13, 0]);
  await tx;
}));

//https://etherscan.io/tx/0xf4428462060cc443e9d19a5048ad31dcae46497e1133a0f3016e31c62596067e
// but f342432 instead of f242432 to raise unknownMethod warning. Also, maker-buy address is modified to match ledger (5998feaf62ef1888c5c2df238d0580018888bff9 -> fe984369ce3919aa7bb4f431082d027b4f8ed70c)
test('[Nano S] atomicMatch_nested_multiple_methodId', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0x02f94c590178844430e409850b732cebc98320a0b3947be8076f4ea4a4ad08075c2508e481d6c946d12b87f8b0a10e470000b94be4ab834bab0000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000fe984369ce3919aa7bb4f431082d027b4f8ed70c0000000000000000000000009a1e3736851633e52c719c7b51c9820641af578a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c5000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b0000000000000000000000009a1e3736851633e52c719c7b51c9820641af578a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003e800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f8b0a10e47000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000061581eba00000000000000000000000000000000000000000000000000000000000000001911971142a502d67d30374066dfdc9c97d8ddb99e96c679f9c737d943df08df00000000000000000000000000000000000000000000000000000000000003e800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f8b0a10e470000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000614f07f100000000000000000000000000000000000000000000000000000000000000007b5d0e30b470c5677447696879c2d1fcdbaac7c71a9d6501a38be05941905a5c0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000006a000000000000000000000000000000000000000000000000000000000000017e000000000000000000000000000000000000000000000000000000000000029200000000000000000000000000000000000000000000000000000000000003a600000000000000000000000000000000000000000000000000000000000004ba00000000000000000000000000000000000000000000000000000000000004bc0000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000001c8344116acfd22bc91561ee6d86c84b1bcbc3530c1da4c7e0ac2c8da7db8ec7933b4c140bba0e9d04e13514117a43891f959a9a8bc2db0a252436b54a8abbaf258344116acfd22bc91561ee6d86c84b1bcbc3530c1da4c7e0ac2c8da7db8ec7933b4c140bba0e9d04e13514117a43891f959a9a8bc2db0a252436b54a8abbaf250000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000110468f0bcaa0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000026000000000000000000000000000000000000000000000000000000000000004400000000000000000000000000000000000000000000000000000000000000620000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c40000000000000000000000000000000000000000000000000000000000000ab8f342432a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005998feaf62ef1888c5c2df238d0580018888bff90000000000000000000000000000000000000000000000000000000000000023000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005998feaf62ef1888c5c2df238d0580018888bff90000000000000000000000000000000000000000000000000000000000000024000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005998feaf62ef1888c5c2df238d0580018888bff90000000000000000000000000000000000000000000000000000000000000025000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005998feaf62ef1888c5c2df238d0580018888bff90000000000000000000000000000000000000000000000000000000000000026000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005998feaf62ef1888c5c2df238d0580018888bff90000000000000000000000000000000000000000000000000000000000000027000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005998feaf62ef1888c5c2df238d0580018888bff90000000000000000000000000000000000000000000000000000000000000028000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005998feaf62ef1888c5c2df238d0580018888bff90000000000000000000000000000000000000000000000000000000000000029000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005998feaf62ef1888c5c2df238d0580018888bff9000000000000000000000000000000000000000000000000000000000000002a000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005998feaf62ef1888c5c2df238d0580018888bff9000000000000000000000000000000000000000000000000000000000000002b000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005998feaf62ef1888c5c2df238d0580018888bff9000000000000000000000000000000000000000000000000000000000000002c000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005998feaf62ef1888c5c2df238d0580018888bff9000000000000000000000000000000000000000000000000000000000000002d000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005998feaf62ef1888c5c2df238d0580018888bff9000000000000000000000000000000000000000000000000000000000000002e000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005998feaf62ef1888c5c2df238d0580018888bff9000000000000000000000000000000000000000000000000000000000000002f000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005998feaf62ef1888c5c2df238d0580018888bff90000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000110468f0bcaa0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000026000000000000000000000000000000000000000000000000000000000000004400000000000000000000000000000000000000000000000000000000000000620000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f00000000000000000000000054f456b544abfb785694400bcb1d85629b2d437f000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c400000000000000000000000000000000000000000000000000000000000000c40000000000000000000000000000000000000000000000000000000000000ab8f242432a0000000000000000000000009a1e3736851633e52c719c7b51c9820641af578a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000023000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000009a1e3736851633e52c719c7b51c9820641af578a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000024000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000009a1e3736851633e52c719c7b51c9820641af578a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000025000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000009a1e3736851633e52c719c7b51c9820641af578a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000026000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000009a1e3736851633e52c719c7b51c9820641af578a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000027000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000009a1e3736851633e52c719c7b51c9820641af578a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000028000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000009a1e3736851633e52c719c7b51c9820641af578a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000029000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000009a1e3736851633e52c719c7b51c9820641af578a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002a000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000009a1e3736851633e52c719c7b51c9820641af578a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002b000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000009a1e3736851633e52c719c7b51c9820641af578a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002c000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000009a1e3736851633e52c719c7b51c9820641af578a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002d000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000009a1e3736851633e52c719c7b51c9820641af578a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002e000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000009a1e3736851633e52c719c7b51c9820641af578a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002f000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000f242432a0000000000000000000000009a1e3736851633e52c719c7b51c9820641af578a00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000030000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001104000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000011040000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c001a0d8e1d593a35b1ddd5d7210f64305553810b81aedded89eae2a67bd4380ba3f2ca0555a282637a1778a4c0122860699370acffc5ddd04790ce0c20779f0e9c069e9");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution,
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'atomicMatch_nested_multiple_methodId', [13, 0]);
  await tx;
}));

test('[Nano S] penzo', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0x02f90bda014a8459682f0085117baba90d8303f111947f268357a8c2552623316e2562d90e642bb538e58801f161421c8e0000b90b64ab834bab0000000000000000000000007f268357a8c2552623316e2562d90e642bb538e5000000000000000000000000f5413c13726fc67c1eae94ffd967e0a3fb681e33000000000000000000000000d4151a376367a140315ed1b4e945dbc4cdbab5090000000000000000000000000000000000000000000000000000000000000000000000000000000000000000baf2127b49fc93cbca6269fade0f7f31df4c88a7000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007f268357a8c2552623316e2562d90e642bb538e5000000000000000000000000d4151a376367a140315ed1b4e945dbc4cdbab50900000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000baf2127b49fc93cbca6269fade0f7f31df4c88a70000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002ee00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001f161421c8e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000621e40830000000000000000000000000000000000000000000000000000000000000000be243da2901ea9118410c962064d8f115dffd51e2ddf57ca9a6949d9f211785f00000000000000000000000000000000000000000000000000000000000002ee00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001f161421c8e0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000621e3fae0000000000000000000000000000000000000000000000000000000062277a5fc8ba87f56226cbeb56703f8203416b9feb43b08707822380b88031ddf1d8507e0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000006a000000000000000000000000000000000000000000000000000000000000007c000000000000000000000000000000000000000000000000000000000000008e00000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000b200000000000000000000000000000000000000000000000000000000000000b40000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000001c0cb5fc152e8668d46be6d734854226e126e5bed19e7b795416fa2b1e2a9eb72744b31918366742e3b725ae413e88e4ff74bf26f03bdd8168eb49df45f31584b60cb5fc152e8668d46be6d734854226e126e5bed19e7b795416fa2b1e2a9eb72744b31918366742e3b725ae413e88e4ff74bf26f03bdd8168eb49df45f31584b6000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e4fb16a5950000000000000000000000000000000000000000000000000000000000000000000000000000000000000000f5413c13726fc67c1eae94ffd967e0a3fb681e33000000000000000000000000846716328715a312efd0d89c43938bb5c9f342d6000000000000000000000000000000000000000000000000000000000000088a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e4fb16a595000000000000000000000000d4151a376367a140315ed1b4e945dbc4cdbab5090000000000000000000000000000000000000000000000000000000000000000000000000000000000000000846716328715a312efd0d89c43938bb5c9f342d6000000000000000000000000000000000000000000000000000000000000088a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e400000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e4000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c001a05e938d55c335d7c94b2f206c80e04a28b7577c3ca77d69e91e45f5cd5f5e8f4ca03787371f861001b8882c1837cd63fae76e85b389986d94c831f96b5df32fd7e9");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'penzo', [11, 0]);
  await tx;
}));

// https://etherscan.io/tx/0x8151c3fe62c9215b0c88f00e063e3ef6de0639ebbbef9cc91273095affe25b18
test('[Nano S] glenn_eth', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0x02f90bba0116843b9aca00850c579552348304f76f947f268357a8c2552623316e2562d90e642bb538e588013fbe85edc90000b90b44ab834bab0000000000000000000000007f268357a8c2552623316e2562d90e642bb538e50000000000000000000000007c15f3c5b70477f5d5d1b78b4bc9a905ef5bfedd000000000000000000000000d6ca3ffe8f3ce2553ddf779087ecc7a2ba7f9f520000000000000000000000000000000000000000000000000000000000000000000000000000000000000000baf2127b49fc93cbca6269fade0f7f31df4c88a7000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007f268357a8c2552623316e2562d90e642bb538e5000000000000000000000000d6ca3ffe8f3ce2553ddf779087ecc7a2ba7f9f5200000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000baf2127b49fc93cbca6269fade0f7f31df4c88a70000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003e8000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000013fbe85edc9000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000062229d470000000000000000000000000000000000000000000000000000000000000000136e3d17253df7529a3d2098aef66ad0078ab73b62722ef2f227c46349d108ec00000000000000000000000000000000000000000000000000000000000003e8000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000013fbe85edc9000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000062229c63000000000000000000000000000000000000000000000000000000006222b8c3da491c7b3e42890e815de13b2abd526e7048b8da4f57384504d5dd4df98a687e0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000006a000000000000000000000000000000000000000000000000000000000000007c000000000000000000000000000000000000000000000000000000000000008e00000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000b200000000000000000000000000000000000000000000000000000000000000b20000000000000000000000000000000000000000000000000000000000000001c000000000000000000000000000000000000000000000000000000000000001ce3acc64fcec9a5e9305bf9f4b9cc199aee6d4954594712f5da97709e34bbce9f3f3a780ca273b27536e1879dfb4500191735ee4af58f997f8be53b344f5e5801e3acc64fcec9a5e9305bf9f4b9cc199aee6d4954594712f5da97709e34bbce9f3f3a780ca273b27536e1879dfb4500191735ee4af58f997f8be53b344f5e5801000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e4fb16a59500000000000000000000000000000000000000000000000000000000000000000000000000000000000000007c15f3c5b70477f5d5d1b78b4bc9a905ef5bfedd0000000000000000000000007c87b6ff9c2ec3466c6fac9b89bb58a4bf12a5bb0000000000000000000000000000000000000000000000000000000000001ecc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e4fb16a595000000000000000000000000d6ca3ffe8f3ce2553ddf779087ecc7a2ba7f9f5200000000000000000000000000000000000000000000000000000000000000000000000000000000000000007c87b6ff9c2ec3466c6fac9b89bb58a4bf12a5bb0000000000000000000000000000000000000000000000000000000000001ecc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e400000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e4000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c001a0041c19c1b7c900f984eaa9a542e9f692207dabc6f8980a43046345b75a1aaceaa0747230e777a62e444da2e14785b4a01158b333bb3648119af5251c41239b677b");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'glenn_eth', [17, 0]);
  await tx;
}));

// https://etherscan.io/tx/0x2ba64df7b335e56574566753fe8eb9560f96145cc603c09357649d7dcaefa140
test('[Nano S] glenn_weth', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0x02f90bb30181d28459682f00851148cf243a83066d30947f268357a8c2552623316e2562d90e642bb538e580b90b44ab834bab0000000000000000000000007f268357a8c2552623316e2562d90e642bb538e5000000000000000000000000dd2b3f1d3a4f08622a25a3f75284fc01ad0c5cca00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000baf2127b49fc93cbca6269fade0f7f31df4c88a70000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc20000000000000000000000007f268357a8c2552623316e2562d90e642bb538e5000000000000000000000000af75696b63745470e74b752c38f8413095d076a7000000000000000000000000dd2b3f1d3a4f08622a25a3f75284fc01ad0c5cca0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000baf2127b49fc93cbca6269fade0f7f31df4c88a70000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc20000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000015e000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000214e8348c4f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006222ae22000000000000000000000000000000000000000000000000000000006226a2fbaa34e3e28d045c301500f8055ae75752e2373df00eabbd8133d8e9c761ef77880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000015e000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000214e8348c4f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006222aea0000000000000000000000000000000000000000000000000000000000000000003305431553d179bdafdcefdf095078c00adf56a6e8a1051c0169ea243e78ac90000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000006a000000000000000000000000000000000000000000000000000000000000007c000000000000000000000000000000000000000000000000000000000000008e00000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000b200000000000000000000000000000000000000000000000000000000000000b20000000000000000000000000000000000000000000000000000000000000001b000000000000000000000000000000000000000000000000000000000000001bc6fd03d1d2a2ed882329ef5f49a874a96f8d9c37ca9164fa661f508e10ceaf14470961829127f35646ca58ba84d0ce25499dfdc2a05ca2dc63e4b6166d664d43c6fd03d1d2a2ed882329ef5f49a874a96f8d9c37ca9164fa661f508e10ceaf14470961829127f35646ca58ba84d0ce25499dfdc2a05ca2dc63e4b6166d664d43000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e4fb16a5950000000000000000000000000000000000000000000000000000000000000000000000000000000000000000dd2b3f1d3a4f08622a25a3f75284fc01ad0c5cca0000000000000000000000008b4616926705fb61e9c4eeac07cd946a5d4b0760000000000000000000000000000000000000000000000000000000000000257c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e4fb16a595000000000000000000000000af75696b63745470e74b752c38f8413095d076a700000000000000000000000000000000000000000000000000000000000000000000000000000000000000008b4616926705fb61e9c4eeac07cd946a5d4b0760000000000000000000000000000000000000000000000000000000000000257c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e400000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e4000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c001a05a7143ea9cf51ec40bafb34129c4b3cab92fd1cf89085f13a9cfeb23e43f0e3ba055419091122e775711c7882bb8cbf501a4e5feec71573a4c3f5670bd6a9f1cdf");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'glenn_weth', [11, 0]);
  await tx;
}));

// https://etherscan.io/tx/0x2ba64df7b335e56574566753fe8eb9560f96145cc603c09357649d7dcaefa140 but WETH address modified to raise unknown paymen token (c02aaa -> c02aab)
test('[Nano S] glenn_unknown_token', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0x02f90bb30181d28459682f00851148cf243a83066d30947f268357a8c2552623316e2562d90e642bb538e580b90b44ab834bab0000000000000000000000007f268357a8c2552623316e2562d90e642bb538e5000000000000000000000000dd2b3f1d3a4f08622a25a3f75284fc01ad0c5cca00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000baf2127b49fc93cbca6269fade0f7f31df4c88a70000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c02aab39b223fe8d0a0e5c4f27ead9083c756cc20000000000000000000000007f268357a8c2552623316e2562d90e642bb538e5000000000000000000000000af75696b63745470e74b752c38f8413095d076a7000000000000000000000000dd2b3f1d3a4f08622a25a3f75284fc01ad0c5cca0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000baf2127b49fc93cbca6269fade0f7f31df4c88a70000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc20000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000015e000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000214e8348c4f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006222ae22000000000000000000000000000000000000000000000000000000006226a2fbaa34e3e28d045c301500f8055ae75752e2373df00eabbd8133d8e9c761ef77880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000015e000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000214e8348c4f00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006222aea0000000000000000000000000000000000000000000000000000000000000000003305431553d179bdafdcefdf095078c00adf56a6e8a1051c0169ea243e78ac90000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000006a000000000000000000000000000000000000000000000000000000000000007c000000000000000000000000000000000000000000000000000000000000008e00000000000000000000000000000000000000000000000000000000000000a000000000000000000000000000000000000000000000000000000000000000b200000000000000000000000000000000000000000000000000000000000000b20000000000000000000000000000000000000000000000000000000000000001b000000000000000000000000000000000000000000000000000000000000001bc6fd03d1d2a2ed882329ef5f49a874a96f8d9c37ca9164fa661f508e10ceaf14470961829127f35646ca58ba84d0ce25499dfdc2a05ca2dc63e4b6166d664d43c6fd03d1d2a2ed882329ef5f49a874a96f8d9c37ca9164fa661f508e10ceaf14470961829127f35646ca58ba84d0ce25499dfdc2a05ca2dc63e4b6166d664d43000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e4fb16a5950000000000000000000000000000000000000000000000000000000000000000000000000000000000000000dd2b3f1d3a4f08622a25a3f75284fc01ad0c5cca0000000000000000000000008b4616926705fb61e9c4eeac07cd946a5d4b0760000000000000000000000000000000000000000000000000000000000000257c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e4fb16a595000000000000000000000000af75696b63745470e74b752c38f8413095d076a700000000000000000000000000000000000000000000000000000000000000000000000000000000000000008b4616926705fb61e9c4eeac07cd946a5d4b0760000000000000000000000000000000000000000000000000000000000000257c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e400000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e4000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c001a05a7143ea9cf51ec40bafb34129c4b3cab92fd1cf89085f13a9cfeb23e43f0e3ba055419091122e775711c7882bb8cbf501a4e5feec71573a4c3f5670bd6a9f1cdf");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'glenn_unknown_token', [11, 0]);
  await tx;
}));