import "core-js/stable";
import "regenerator-runtime/runtime";
import { waitForAppScreen, zemu, genericTx, SPECULOS_ADDRESS, RANDOM_ADDRESS, txFromEtherscan } from './test.fixture';
import { ethers } from "ethers";
import { parseEther, parseUnits } from "ethers/lib/utils";

// EDIT THIS: Replace with your contract address
const contractAddr = "0x7be8076f4ea4a4ad08075c2508e481d6c946d12b";
// EDIT THIS: Replace `boilerplate` with your plugin name
const pluginName = "opensea";
const abi_path = `../${pluginName}/abis/` + contractAddr + '.json';
const abi = require(abi_path);

// handcrafted Txs not working yet
test.skip('[Nano S] handcraft cancelOrder [not working]', zemu("nanos", async (sim, eth) => {
  const contract = new ethers.Contract(contractAddr, abi);

  // Constants used to create the transaction
  // EDIT THIS: Remove what you don't need
  const addrs = [
    '0x7Be8076f4EA4A4AD08075C2508e481d6C946D12b',
    '0xCc08953B870d8D7021DEB25948ab1CB512395862',
    '0x79782B0Ae9b71CFf36bB32b4eF0935Fd3C190350',
    '0x5b3256965e7C3cF26E11FCAf296DfC8807C01073',
    '0x495f947276749Ce646f68AC8c248420045cb7b5e',
    '0x0000000000000000000000000000000000000000',
    '0x0000000000000000000000000000000000000000'
  ]
  const uints = [
    350,
    0,
    0,
    0,
    parseUnits('2000000000000000000', 'wei'),
    0,
    1633800893,
    1634060157,
    ethers.BigNumber.from('26058293234568764867237013327745127527778250572354028944674590902890524764596')
  ]
  const feeMethod = 1
  const side = 1
  const saleKind = 0
  const howToCall = 0
  const calldata = '0xf242432a000000000000000000000000cc08953b870d8d7021deb25948ab1cb5123958620000000000000000000000000000000000000000000000000000000000000000cc08953b870d8d7021deb25948ab1cb512395862000000000000230000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000a00000000000000000000000000000000000000000000000000000000000000000'
  const replacementPattern = '0x000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000'
  const staticExtradata = ''
  const v = '27'
  const r = '0xd0577a00c2480df9b7648feb26abde80d0016bdd7cc5b59aa8985624ff8bd9ff'
  const s = '0x220eae8074c5855d05e6220192a0d5c59ae0447f5c13b4816f4d26c283f68254'
  //
  const amountOutMin = parseUnits("28471151959593036279", 'wei');
  const WETH = "0xc02aaa39b223fe8d0a0e5c4f27ead9083c756cc2";
  const SUSHI = "0x6b3595068778dd592e39a122f4f5a5cf09c90fe2";
  const path = [WETH, SUSHI];
  const deadline = Number(1632843280);
  const beneficiary = "0x15557c8b7246C38EE71eA6dc69e4347F5DAc2104";

  // EDIT THIS: adapt the signature to your method
  // signature: swapExactETHForTokens(uint amountOutMin, address[] calldata path, address to, uint deadline)
  // EDIT THIS: don't call `swapExactETHForTokens` but your own method and adapt the arguments.
  // const { data } = await contract.populateTransaction.swapExactETHForTokens(amountOutMin, path, beneficiary, deadline);
  const { data } = await contract.populateTransaction.cancelOrder_(addrs, uints, feeMethod, side, saleKind, howToCall, calldata, replacementPattern, staticExtradata, v, r, s);

  // Get the generic transaction template
  let unsignedTx = genericTx;
  // Modify `to` to make it interact with the contract
  unsignedTx.to = contractAddr;
  // Modify the attached data
  unsignedTx.data = data;
  // EDIT THIS: get rid of this if you don't wish to modify the `value` field.
  // Modify the number of ETH sent
  // unsignedTx.value = parseEther("0.1");

  // Create serializedTx and remove the "0x" prefix
  const serializedTx = ethers.utils.serializeTransaction(unsignedTx).slice(2);

  // Rather than constructing the tx ourselves, one can can obtain it directly through etherscan.
  // The rawTx of the tx up above is accessible through: https://etherscan.io/getRawTx?tx=0xb27a69cd3190ad0712da39f6b809ecc019ecbc319d3c17169853270226d18a8a
  // In this case, you could remove the above code, and simply create your tx like so:
  // const serializedTx = txFromEtherscan("0x02f9015a0181d38459682f0085215d7c1e598302a4e9947a250d5630b4cf539739df2c5dacb4c659f2488d88016345785d8a0000b8e47ff36ab50000000000000000000000000000000000000000000000018b1dd9dc51b5a9f7000000000000000000000000000000000000000000000000000000000000008000000000000000000000000015557c8b7246c38ee71ea6dc69e4347f5dac210400000000000000000000000000000000000000000000000000000000615336100000000000000000000000000000000000000000000000000000000000000002000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc20000000000000000000000006b3595068778dd592e39a122f4f5a5cf09c90fe2c001a089c5ce4ce199f7d93ea1d54c08133fab9407d8de63a9885d59d8ce69a59573dda045f6a0e0d3288dfdfddc23ad0afb9577c4011801f598d581a46cd0b0e2bd0571");

  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx
  );

  // Wait for the application to actually load and parse the transaction
  await waitForAppScreen(sim);
  // Navigate the display by pressing the right button 10 times, then pressing both buttons to accept the transaction.
  // EDIT THIS: modify `10` to fix the number of screens you are expecting to navigate through.
  await sim.navigateAndCompareSnapshots('.', 'nanos_swap_exact_eth_for_tokens_with_beneficiary', [10, 0]);

  await tx;
}));

test('[Nano S] cancel order sell single address eth', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0x02f90512010b8459682f00851b9dca1a7c8301b729947be8076f4ea4a4ad08075c2508e481d6c946d12b80b904a4a8a41c700000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b00000000000000000000000093485a248c18f6c7f49ef14b5312c62baab4841e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000a406489360a47af2c74fc1004316a64e469646a50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001f400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004db732547630000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000615e083c00000000000000000000000000000000000000000000000000000000624cf06faf12c4b22c5435c10d8df37420d3d171dc30437e1ac3cb4acfdaab32bb00ce1e0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000034000000000000000000000000000000000000000000000000000000000000003e00000000000000000000000000000000000000000000000000000000000000480000000000000000000000000000000000000000000000000000000000000001b7ba472be2c8693f19ff6c85b504961c5f56e314fddc265ba47469042b45f8b0a6b4ab0b6dfe519a015039af0b8df4fa48110852a9e5c99220fbd8d617a7816cd000000000000000000000000000000000000000000000000000000000000006423b872dd00000000000000000000000093485a248c18f6c7f49ef14b5312c62baab4841e000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007a2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c001a040d02ab354683f19080562799afdd3465aa5b657cf36077030fce212c5deea78a030673f60ba110ab3ea14b32dbf30f36ee2cfc71845ce35a89883b7ed58f9686b");
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
  );
  // Wait for the application to actually load and parse the transaction
  await waitForAppScreen(sim);
  // Navigate the display by pressing the right button 6 times, then pressing both buttons to accept the transaction.
  await sim.navigateAndCompareSnapshots('.', 'nanos_cancelOrder_sell_single_address_eth', [11, 0]);
  await tx;
}));

// https://etherscan.io/tx/0x6179a998dfec03c4cfac84df347c249aa41f9fe1a3ef1d111cd327327475cc9e
test('[Nano S] cancel single eth buy', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0x02f905130181f18459682f00850f605d3148830124ae947be8076f4ea4a4ad08075c2508e481d6c946d12b80b904a4a8a41c700000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000f790d735ea4dca6f152b86cc7e32e043bdd0bb8800000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000bea8123277142de42571f1fac045225a1d3479770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003fc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000d02ab486cedc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000061268c620000000000000000000000000000000000000000000000000000000000000000560fb2444444b6cb83b9bddcc2a1ed21c1cae74fe1631bf6546b176c59af6e180000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000034000000000000000000000000000000000000000000000000000000000000003e00000000000000000000000000000000000000000000000000000000000000480000000000000000000000000000000000000000000000000000000000000001cec13ca70871103c94e9762b5c7f7ca892fbcdbd88abb5c7591e85bdbcf2ed24d7680e5c22248bab74607498835d28487c2b8029e700328cec65fd7a5d1495d8e000000000000000000000000000000000000000000000000000000000000006423b872dd000000000000000000000000f790d735ea4dca6f152b86cc7e32e043bdd0bb880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000031a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c001a0638b26a6fe48126e26391494fe8ba9d667a8e1e4d79c244c9d505c9dec14c0fba04d50ae7e6473635dd83a18af33b6c2fb3adf8cbfb941b490f2153449873b128b");
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'nanos_cancelOrder_buy_single_address_eth', [11, 0]);
  await tx;
}));

// https://etherscan.io/tx/0xe7c07b6ab181c3f957b7883676dc7a70476d58691c5ea16c385e7d7f99ebc76e
test('[Nano S] cancel single eth buy, tranferFrom', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0x02f90512010b8459682f00851b9dca1a7c8301b729947be8076f4ea4a4ad08075c2508e481d6c946d12b80b904a4a8a41c700000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b00000000000000000000000093485a248c18f6c7f49ef14b5312c62baab4841e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000a406489360a47af2c74fc1004316a64e469646a50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001f400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004db732547630000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000615e083c00000000000000000000000000000000000000000000000000000000624cf06faf12c4b22c5435c10d8df37420d3d171dc30437e1ac3cb4acfdaab32bb00ce1e0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000034000000000000000000000000000000000000000000000000000000000000003e00000000000000000000000000000000000000000000000000000000000000480000000000000000000000000000000000000000000000000000000000000001b7ba472be2c8693f19ff6c85b504961c5f56e314fddc265ba47469042b45f8b0a6b4ab0b6dfe519a015039af0b8df4fa48110852a9e5c99220fbd8d617a7816cd000000000000000000000000000000000000000000000000000000000000006423b872dd00000000000000000000000093485a248c18f6c7f49ef14b5312c62baab4841e000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007a2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c001a040d02ab354683f19080562799afdd3465aa5b657cf36077030fce212c5deea78a030673f60ba110ab3ea14b32dbf30f36ee2cfc71845ce35a89883b7ed58f9686b");
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'nanos_cancel_order_single_eth_buy_tranferFrom', [9, 0]);
  await tx;
}));

// https://etherscan.io/tx/0xd850588de243f630441b1ee84e862d9d91279a0f5484e59b04bad7097f036015
test('[Nano S] cancel single weth sell, tranferFrom', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0x02f90512011a8459682f0085186df7f5d4830125b6947be8076f4ea4a4ad08075c2508e481d6c946d12b80b904a4a8a41c700000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000cad7c65a3043a56dbd533ce671b6bb63e203309d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c0107300000000000000000000000011111111384122718f7a44d48290bb70a3a9f7930000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003e80000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000029a2241af62c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000615fe9ef00000000000000000000000000000000000000000000000000000000616924b956bdb7308d46971016aa2a1d7612ee3add17e2432c83838a282255a59880545a0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000034000000000000000000000000000000000000000000000000000000000000003e00000000000000000000000000000000000000000000000000000000000000480000000000000000000000000000000000000000000000000000000000000001b5aa0407b89aa7a7800d7df0103c789626b3d89a66132ff4d3515ea4fcd3ce80a4865564d10181abbccdfee75ffa48bed56c41be0ec71b0a44434e57060982a26000000000000000000000000000000000000000000000000000000000000006423b872dd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000cad7c65a3043a56dbd533ce671b6bb63e203309d00000000000000000000000000000000000000000000000000000000000002aa00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006400000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c001a046968c532e2706731d5222e9af53ab959a8e4997e6b4605cbe485e0a7eb4673ca002cce049a011c75b5b9f4bdcff0004b20da792dbb924963bef5361c463ba9b2a");
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'nanos_cancel_order_single_weth_sell_tranferFrom', [10, 0]);
  await tx;
}));

// https://etherscan.io/tx/0xd850588de243f630441b1ee84e862d9d91279a0f5484e59b04bad7097f036015
// but WETH address is misstyped
test('[Nano S] cancel buy single adress weth', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0x02f90512011a8459682f0085186df7f5d4830125b6947be8076f4ea4a4ad08075c2508e481d6c946d12b80b904a4a8a41c700000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000cad7c65a3043a56dbd533ce671b6bb63e203309d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c0107300000000000000000000000011111111384122718f7a44d48290bb70a3a9f7930000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c02baa39b223fe8d0a0e5c4f27ead9083c756cc2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003e80000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000029a2241af62c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000615fe9ef00000000000000000000000000000000000000000000000000000000616924b956bdb7308d46971016aa2a1d7612ee3add17e2432c83838a282255a59880545a0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000034000000000000000000000000000000000000000000000000000000000000003e00000000000000000000000000000000000000000000000000000000000000480000000000000000000000000000000000000000000000000000000000000001b5aa0407b89aa7a7800d7df0103c789626b3d89a66132ff4d3515ea4fcd3ce80a4865564d10181abbccdfee75ffa48bed56c41be0ec71b0a44434e57060982a26000000000000000000000000000000000000000000000000000000000000006423b872dd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000cad7c65a3043a56dbd533ce671b6bb63e203309d00000000000000000000000000000000000000000000000000000000000002aa00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006400000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c001a046968c532e2706731d5222e9af53ab959a8e4997e6b4605cbe485e0a7eb4673ca002cce049a011c75b5b9f4bdcff0004b20da792dbb924963bef5361c463ba9b2a");
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'nanos_cancelOrder_buy_single_address_weth', [12, 0]);
  await tx;
}));

// https://etherscan.io/tx/0xa700eecb9264881e26d266017e5e668e447921b4170e804fa249cd542d001a3a
test('[Nano S] cancel bundle eth buy, atomicize', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0xf91bcd8207bc850d4576fa008303c8fa947be8076f4ea4a4ad08075c2508e481d6c946d12b80b91b64a8a41c700000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f100000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007ce66c50e28400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006094bdf600000000000000000000000000000000000000000000000000000000000000006050c7559c7884736a2bd436e458ae32b9c86b511130965ff6f6dc485eecbb26000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000003400000000000000000000000000000000000000000000000000000000000000f400000000000000000000000000000000000000000000000000000000000001b40000000000000000000000000000000000000000000000000000000000000001bb2de0411b316f8d6845f660d78ac11c123c6ae23054f33e49dc6b9d2c10c7d461649c2f3d6a8695dbf6f2766ff8b6a0cb05e0a402f7751d37cecec2e8f4e36eb0000000000000000000000000000000000000000000000000000000000000bc468f0bcaa0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000026000000000000000000000000000000000000000000000000000000000000004400000000000000000000000000000000000000000000000000000000000000620000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000640000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000006400000000000000000000000000000000000000000000000000000000000000640000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000006400000000000000000000000000000000000000000000000000000000000000640000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000006400000000000000000000000000000000000000000000000000000000000000640000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000006400000000000000000000000000000000000000000000000000000000000000640000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000057823b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000042023b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000042223b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000046023b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000055a23b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000056d23b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005ac23b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ca23b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000098123b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000009a723b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000017223b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001c123b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000032523b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000033b23b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003670000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000bc40000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000026a0472e8d13ec71176b4ed35b0bcfa26d220b69e8c1af32b24d230b5c2eef88d64ba02f4e2ef3607d8c8412edeb3f241927b333ee9babfbce15b40f7957fd0a11eff5");
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'nanos_cancel_order_bundle_unknown_buy_atomicize', [12, 0]);
  await tx;
}));


// Nano X's test not working yet
test.skip('[Nano X] cancel order test PENZO', zemu("nanox", async (sim, eth) => {

  const serializedTx = txFromEtherscan("0x02f90512010b8459682f00851b9dca1a7c8301b729947be8076f4ea4a4ad08075c2508e481d6c946d12b80b904a4a8a41c700000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b00000000000000000000000093485a248c18f6c7f49ef14b5312c62baab4841e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000a406489360a47af2c74fc1004316a64e469646a50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001f400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004db732547630000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000615e083c00000000000000000000000000000000000000000000000000000000624cf06faf12c4b22c5435c10d8df37420d3d171dc30437e1ac3cb4acfdaab32bb00ce1e0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000034000000000000000000000000000000000000000000000000000000000000003e00000000000000000000000000000000000000000000000000000000000000480000000000000000000000000000000000000000000000000000000000000001b7ba472be2c8693f19ff6c85b504961c5f56e314fddc265ba47469042b45f8b0a6b4ab0b6dfe519a015039af0b8df4fa48110852a9e5c99220fbd8d617a7816cd000000000000000000000000000000000000000000000000000000000000006423b872dd00000000000000000000000093485a248c18f6c7f49ef14b5312c62baab4841e000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007a2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c001a040d02ab354683f19080562799afdd3465aa5b657cf36077030fce212c5deea78a030673f60ba110ab3ea14b32dbf30f36ee2cfc71845ce35a89883b7ed58f9686b");
  // const serializedTx = txFromEtherscan("0x02f9015a0181d38459682f0085215d7c1e598302a4e9947a250d5630b4cf539739df2c5dacb4c659f2488d88016345785d8a0000b8e47ff36ab50000000000000000000000000000000000000000000000018b1dd9dc51b5a9f7000000000000000000000000000000000000000000000000000000000000008000000000000000000000000015557c8b7246c38ee71ea6dc69e4347f5dac210400000000000000000000000000000000000000000000000000000000615336100000000000000000000000000000000000000000000000000000000000000002000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc20000000000000000000000006b3595068778dd592e39a122f4f5a5cf09c90fe2c001a089c5ce4ce199f7d93ea1d54c08133fab9407d8de63a9885d59d8ce69a59573dda045f6a0e0d3288dfdfddc23ad0afb9577c4011801f598d581a46cd0b0e2bd0571");

  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
  );

  // Wait for the application to actually load and parse the transaction
  await waitForAppScreen(sim);
  // Navigate the display by pressing the right button 6 times, then pressing both buttons to accept the transaction.
  await sim.navigateAndCompareSnapshots('.', 'nanox_cancel_order', [9, 0]);

  await tx;
}));