import "core-js/stable";
import "regenerator-runtime/runtime";
import { waitForAppScreen, zemu, txFromEtherscan, boilerplateJSON, resolutionConfig, loadConfig } from './test.fixture';
import ledgerService from "@ledgerhq/hw-app-eth/lib/services/ledger"

// https://etherscan.io/tx/0x6179a998dfec03c4cfac84df347c249aa41f9fe1a3ef1d111cd327327475cc9e
test('[Nano S] nanos_cancelOrder_buy_single_nftAddress_eth', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0x02f905130181f18459682f00850f605d3148830124ae947be8076f4ea4a4ad08075c2508e481d6c946d12b80b904a4a8a41c700000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000f790d735ea4dca6f152b86cc7e32e043bdd0bb8800000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000bea8123277142de42571f1fac045225a1d3479770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003fc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000d02ab486cedc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000061268c620000000000000000000000000000000000000000000000000000000000000000560fb2444444b6cb83b9bddcc2a1ed21c1cae74fe1631bf6546b176c59af6e180000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000034000000000000000000000000000000000000000000000000000000000000003e00000000000000000000000000000000000000000000000000000000000000480000000000000000000000000000000000000000000000000000000000000001cec13ca70871103c94e9762b5c7f7ca892fbcdbd88abb5c7591e85bdbcf2ed24d7680e5c22248bab74607498835d28487c2b8029e700328cec65fd7a5d1495d8e000000000000000000000000000000000000000000000000000000000000006423b872dd000000000000000000000000f790d735ea4dca6f152b86cc7e32e043bdd0bb880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000031a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c001a0638b26a6fe48126e26391494fe8ba9d667a8e1e4d79c244c9d505c9dec14c0fba04d50ae7e6473635dd83a18af33b6c2fb3adf8cbfb941b490f2153449873b128b");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig,
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution,
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'nanos_cancelOrder_buy_single_nftAddress_eth', [11, 0]);
  await tx;
}));

// https://etherscan.io/tx/0xd850588de243f630441b1ee84e862d9d91279a0f5484e59b04bad7097f036015
test('[Nano S] nanos_cancelOrder_buy_single_nftAddress_weth', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0x02f90512011a8459682f0085186df7f5d4830125b6947be8076f4ea4a4ad08075c2508e481d6c946d12b80b904a4a8a41c700000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000cad7c65a3043a56dbd533ce671b6bb63e203309d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c0107300000000000000000000000011111111384122718f7a44d48290bb70a3a9f7930000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003e80000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000029a2241af62c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000615fe9ef00000000000000000000000000000000000000000000000000000000616924b956bdb7308d46971016aa2a1d7612ee3add17e2432c83838a282255a59880545a0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000034000000000000000000000000000000000000000000000000000000000000003e00000000000000000000000000000000000000000000000000000000000000480000000000000000000000000000000000000000000000000000000000000001b5aa0407b89aa7a7800d7df0103c789626b3d89a66132ff4d3515ea4fcd3ce80a4865564d10181abbccdfee75ffa48bed56c41be0ec71b0a44434e57060982a26000000000000000000000000000000000000000000000000000000000000006423b872dd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000cad7c65a3043a56dbd533ce671b6bb63e203309d00000000000000000000000000000000000000000000000000000000000002aa00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006400000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c001a046968c532e2706731d5222e9af53ab959a8e4997e6b4605cbe485e0a7eb4673ca002cce049a011c75b5b9f4bdcff0004b20da792dbb924963bef5361c463ba9b2a");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig,
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution,
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'nanos_cancelOrder_buy_single_nftAddress_weth', [11, 0]);
  await tx;
}));

// https://etherscan.io/tx/0xd850588de243f630441b1ee84e862d9d91279a0f5484e59b04bad7097f036015
// but WETH address is misstyped (c02aaa -> c02baa)
test('[Nano S] nanos_cancelOrder_buy_single_nftAddress_unknownToken', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0x02f90512011a8459682f0085186df7f5d4830125b6947be8076f4ea4a4ad08075c2508e481d6c946d12b80b904a4a8a41c700000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000cad7c65a3043a56dbd533ce671b6bb63e203309d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c0107300000000000000000000000011111111384122718f7a44d48290bb70a3a9f7930000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c02baa39b223fe8d0a0e5c4f27ead9083c756cc2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003e80000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000029a2241af62c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000615fe9ef00000000000000000000000000000000000000000000000000000000616924b956bdb7308d46971016aa2a1d7612ee3add17e2432c83838a282255a59880545a0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000034000000000000000000000000000000000000000000000000000000000000003e00000000000000000000000000000000000000000000000000000000000000480000000000000000000000000000000000000000000000000000000000000001b5aa0407b89aa7a7800d7df0103c789626b3d89a66132ff4d3515ea4fcd3ce80a4865564d10181abbccdfee75ffa48bed56c41be0ec71b0a44434e57060982a26000000000000000000000000000000000000000000000000000000000000006423b872dd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000cad7c65a3043a56dbd533ce671b6bb63e203309d00000000000000000000000000000000000000000000000000000000000002aa00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006400000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c001a046968c532e2706731d5222e9af53ab959a8e4997e6b4605cbe485e0a7eb4673ca002cce049a011c75b5b9f4bdcff0004b20da792dbb924963bef5361c463ba9b2a");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig,
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution,
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'nanos_cancelOrder_buy_single_nftAddress_unknownToken', [12, 0]);
  await tx;
}));

// https://etherscan.io/tx/0xd850588de243f630441b1ee84e862d9d91279a0f5484e59b04bad7097f036015
// but WETH address is misstyped (c02aaa -> c02baa)
test('[Nano S] nanos_cancelOrder_sell_single_nftAddress_unknownToken', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0x02f90512011a8459682f0085186df7f5d4830125b6947be8076f4ea4a4ad08075c2508e481d6c946d12b80b904a4a8a41c700000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000cad7c65a3043a56dbd533ce671b6bb63e203309d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c0107300000000000000000000000011111111384122718f7a44d48290bb70a3a9f7930000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c02baa39b223fe8d0a0e5c4f27ead9083c756cc2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003e80000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000029a2241af62c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000615fe9ef00000000000000000000000000000000000000000000000000000000616924b956bdb7308d46971016aa2a1d7612ee3add17e2432c83838a282255a59880545a0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000034000000000000000000000000000000000000000000000000000000000000003e00000000000000000000000000000000000000000000000000000000000000480000000000000000000000000000000000000000000000000000000000000001b5aa0407b89aa7a7800d7df0103c789626b3d89a66132ff4d3515ea4fcd3ce80a4865564d10181abbccdfee75ffa48bed56c41be0ec71b0a44434e57060982a26000000000000000000000000000000000000000000000000000000000000006423b872dd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000cad7c65a3043a56dbd533ce671b6bb63e203309d00000000000000000000000000000000000000000000000000000000000002aa00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006400000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c001a046968c532e2706731d5222e9af53ab959a8e4997e6b4605cbe485e0a7eb4673ca002cce049a011c75b5b9f4bdcff0004b20da792dbb924963bef5361c463ba9b2a");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig,
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution,
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'nanos_cancelOrder_sell_single_nftAddress_unknownToken', [12, 0]);
  await tx;
}));

//// https://etherscan.io/tx/0xe7c07b6ab181c3f957b7883676dc7a70476d58691c5ea16c385e7d7f99ebc76e
// But sell bool is modified 0 -> 1
test('[Nano S] nanos_cancelOrder_sell_single_nftAddress_eth', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0x02f90512010b8459682f00851b9dca1a7c8301b729947be8076f4ea4a4ad08075c2508e481d6c946d12b80b904a4a8a41c700000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b00000000000000000000000093485a248c18f6c7f49ef14b5312c62baab4841e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000a406489360a47af2c74fc1004316a64e469646a50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001f400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000004db732547630000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000615e083c00000000000000000000000000000000000000000000000000000000624cf06faf12c4b22c5435c10d8df37420d3d171dc30437e1ac3cb4acfdaab32bb00ce1e0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000034000000000000000000000000000000000000000000000000000000000000003e00000000000000000000000000000000000000000000000000000000000000480000000000000000000000000000000000000000000000000000000000000001b7ba472be2c8693f19ff6c85b504961c5f56e314fddc265ba47469042b45f8b0a6b4ab0b6dfe519a015039af0b8df4fa48110852a9e5c99220fbd8d617a7816cd000000000000000000000000000000000000000000000000000000000000006423b872dd00000000000000000000000093485a248c18f6c7f49ef14b5312c62baab4841e000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007a2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c001a040d02ab354683f19080562799afdd3465aa5b657cf36077030fce212c5deea78a030673f60ba110ab3ea14b32dbf30f36ee2cfc71845ce35a89883b7ed58f9686b");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig,
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution,
  );
  // Wait for the application to actually load and parse the transaction
  await waitForAppScreen(sim);
  // Navigate the display by pressing the right button 6 times, then pressing both buttons to accept the transaction.
  await sim.navigateAndCompareSnapshots('.', 'nanos_cancelOrder_sell_single_nftAddress_eth', [10, 0]);
  await tx;
}));

//https://etherscan.io/tx/0x6179a998dfec03c4cfac84df347c249aa41f9fe1a3ef1d111cd327327475cc9e
// Modified to change Method ID to unknown (23b872 -> 23b972)
test('[Nano S] nanos_cancelOrder_buy_unknownMethod_nftAddress_eth', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0x02f905130181f18459682f00850f605d3148830124ae947be8076f4ea4a4ad08075c2508e481d6c946d12b80b904a4a8a41c700000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000f790d735ea4dca6f152b86cc7e32e043bdd0bb8800000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000bea8123277142de42571f1fac045225a1d3479770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003fc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000d02ab486cedc000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000061268c620000000000000000000000000000000000000000000000000000000000000000560fb2444444b6cb83b9bddcc2a1ed21c1cae74fe1631bf6546b176c59af6e180000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000034000000000000000000000000000000000000000000000000000000000000003e00000000000000000000000000000000000000000000000000000000000000480000000000000000000000000000000000000000000000000000000000000001cec13ca70871103c94e9762b5c7f7ca892fbcdbd88abb5c7591e85bdbcf2ed24d7680e5c22248bab74607498835d28487c2b8029e700328cec65fd7a5d1495d8e000000000000000000000000000000000000000000000000000000000000006423b972dd000000000000000000000000f790d735ea4dca6f152b86cc7e32e043bdd0bb880000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000031a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c001a0638b26a6fe48126e26391494fe8ba9d667a8e1e4d79c244c9d505c9dec14c0fba04d50ae7e6473635dd83a18af33b6c2fb3adf8cbfb941b490f2153449873b128b");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig,
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution,
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'nanos_cancelOrder_buy_unknownMethod_nftAddress_eth', [12, 0]);
  await tx;
}));

// https://etherscan.io/tx/0xd850588de243f630441b1ee84e862d9d91279a0f5484e59b04bad7097f036015
// but WETH address is misstyped for unkown token + method id changed to 23b872dd + 23b972dd).
test('[Nano S] nanos_cancelOrder_buy_unknownMethod_nftAddress_unknownToken', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0x02f90512011a8459682f0085186df7f5d4830125b6947be8076f4ea4a4ad08075c2508e481d6c946d12b80b904a4a8a41c700000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000cad7c65a3043a56dbd533ce671b6bb63e203309d00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c0107300000000000000000000000011111111384122718f7a44d48290bb70a3a9f7930000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c02baa39b223fe8d0a0e5c4f27ead9083c756cc2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003e80000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000029a2241af62c0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000615fe9ef00000000000000000000000000000000000000000000000000000000616924b956bdb7308d46971016aa2a1d7612ee3add17e2432c83838a282255a59880545a0000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000034000000000000000000000000000000000000000000000000000000000000003e00000000000000000000000000000000000000000000000000000000000000480000000000000000000000000000000000000000000000000000000000000001b5aa0407b89aa7a7800d7df0103c789626b3d89a66132ff4d3515ea4fcd3ce80a4865564d10181abbccdfee75ffa48bed56c41be0ec71b0a44434e57060982a26000000000000000000000000000000000000000000000000000000000000006423b972dd0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000cad7c65a3043a56dbd533ce671b6bb63e203309d00000000000000000000000000000000000000000000000000000000000002aa00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006400000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c001a046968c532e2706731d5222e9af53ab959a8e4997e6b4605cbe485e0a7eb4673ca002cce049a011c75b5b9f4bdcff0004b20da792dbb924963bef5361c463ba9b2a");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig,
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution,
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'nanos_cancelOrder_buy_unknownMethod_nftAddress_unknownToken', [13, 0]);
  await tx;
}));


// https://etherscan.io/tx/0xa700eecb9264881e26d266017e5e668e447921b4170e804fa249cd542d001a3a
test('[Nano S] nanos_cancelOrder_sell_bundle_nftAddress_eth', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0xf91bcd8207bc850d4576fa008303c8fa947be8076f4ea4a4ad08075c2508e481d6c946d12b80b91b64a8a41c700000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f100000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007ce66c50e28400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006094bdf600000000000000000000000000000000000000000000000000000000000000006050c7559c7884736a2bd436e458ae32b9c86b511130965ff6f6dc485eecbb26000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000003400000000000000000000000000000000000000000000000000000000000000f400000000000000000000000000000000000000000000000000000000000001b40000000000000000000000000000000000000000000000000000000000000001bb2de0411b316f8d6845f660d78ac11c123c6ae23054f33e49dc6b9d2c10c7d461649c2f3d6a8695dbf6f2766ff8b6a0cb05e0a402f7751d37cecec2e8f4e36eb0000000000000000000000000000000000000000000000000000000000000bc468f0bcaa0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000026000000000000000000000000000000000000000000000000000000000000004400000000000000000000000000000000000000000000000000000000000000620000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000640000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000006400000000000000000000000000000000000000000000000000000000000000640000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000006400000000000000000000000000000000000000000000000000000000000000640000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000006400000000000000000000000000000000000000000000000000000000000000640000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000006400000000000000000000000000000000000000000000000000000000000000640000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000057823b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000042023b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000042223b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000046023b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000055a23b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000056d23b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005ac23b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ca23b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000098123b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000009a723b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000017223b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001c123b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000032523b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000033b23b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003670000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000bc40000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000026a0472e8d13ec71176b4ed35b0bcfa26d220b69e8c1af32b24d230b5c2eef88d64ba02f4e2ef3607d8c8412edeb3f241927b333ee9babfbce15b40f7957fd0a11eff5");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig,
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution,
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'nanos_cancelOrder_sell_bundle_nftAddress_eth', [9, 0]);
  await tx;
}));

// https://etherscan.io/tx/0xa700eecb9264881e26d266017e5e668e447921b4170e804fa249cd542d001a3a
// nft contract addressed modified in call data in order to raise 'multiple' ui (0xce5b -> 0xce5c)
test('[Nano S] nanos_cancelOrder_sell_bundle_multiple_nftAddress_eth', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0xf91bcd8207bc850d4576fa008303c8fa947be8076f4ea4a4ad08075c2508e481d6c946d12b80b91b64a8a41c700000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f100000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007ce66c50e28400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006094bdf600000000000000000000000000000000000000000000000000000000000000006050c7559c7884736a2bd436e458ae32b9c86b511130965ff6f6dc485eecbb26000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000003400000000000000000000000000000000000000000000000000000000000000f400000000000000000000000000000000000000000000000000000000000001b40000000000000000000000000000000000000000000000000000000000000001bb2de0411b316f8d6845f660d78ac11c123c6ae23054f33e49dc6b9d2c10c7d461649c2f3d6a8695dbf6f2766ff8b6a0cb05e0a402f7751d37cecec2e8f4e36eb0000000000000000000000000000000000000000000000000000000000000bc468f0bcaa0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000026000000000000000000000000000000000000000000000000000000000000004400000000000000000000000000000000000000000000000000000000000000620000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5c23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000640000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000006400000000000000000000000000000000000000000000000000000000000000640000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000006400000000000000000000000000000000000000000000000000000000000000640000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000006400000000000000000000000000000000000000000000000000000000000000640000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000006400000000000000000000000000000000000000000000000000000000000000640000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000057823b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000042023b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000042223b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000046023b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000055a23b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000056d23b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005ac23b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ca23b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000098123b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000009a723b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000017223b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001c123b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000032523b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000033b23b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003670000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000bc40000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000026a0472e8d13ec71176b4ed35b0bcfa26d220b69e8c1af32b24d230b5c2eef88d64ba02f4e2ef3607d8c8412edeb3f241927b333ee9babfbce15b40f7957fd0a11eff5");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig,
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution,
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'nanos_cancelOrder_sell_bundle_multiple_nftAddress_eth', [7, 0]);
  await tx;
}));

// https://etherscan.io/tx/0xa700eecb9264881e26d266017e5e668e447921b4170e804fa249cd542d001a3a
// Modified to replace ETH with WETH:
test('[Nano S] nanos_cancelOrder_sell_bundle_nftAddress_weth', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0xf91bcd8207bc850d4576fa008303c8fa947be8076f4ea4a4ad08075c2508e481d6c946d12b80b91b64a8a41c700000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f100000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc200000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007ce66c50e28400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006094bdf600000000000000000000000000000000000000000000000000000000000000006050c7559c7884736a2bd436e458ae32b9c86b511130965ff6f6dc485eecbb26000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000003400000000000000000000000000000000000000000000000000000000000000f400000000000000000000000000000000000000000000000000000000000001b40000000000000000000000000000000000000000000000000000000000000001bb2de0411b316f8d6845f660d78ac11c123c6ae23054f33e49dc6b9d2c10c7d461649c2f3d6a8695dbf6f2766ff8b6a0cb05e0a402f7751d37cecec2e8f4e36eb0000000000000000000000000000000000000000000000000000000000000bc468f0bcaa0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000026000000000000000000000000000000000000000000000000000000000000004400000000000000000000000000000000000000000000000000000000000000620000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000640000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000006400000000000000000000000000000000000000000000000000000000000000640000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000006400000000000000000000000000000000000000000000000000000000000000640000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000006400000000000000000000000000000000000000000000000000000000000000640000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000006400000000000000000000000000000000000000000000000000000000000000640000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000057823b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000042023b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000042223b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000046023b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000055a23b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000056d23b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005ac23b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ca23b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000098123b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000009a723b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000017223b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001c123b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000032523b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000033b23b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003670000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000bc40000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000026a0472e8d13ec71176b4ed35b0bcfa26d220b69e8c1af32b24d230b5c2eef88d64ba02f4e2ef3607d8c8412edeb3f241927b333ee9babfbce15b40f7957fd0a11eff5");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig,
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution,
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'nanos_cancelOrder_sell_bundle_nftAddress_weth', [9, 0]);
  await tx;
}));

// https://etherscan.io/tx/0xa700eecb9264881e26d266017e5e668e447921b4170e804fa249cd542d001a3a
// Modified to replace ETH with unknown token (c02aaa -> c02baa): 
test('[Nano S] nanos_cancelOrder_sell_bundle_nftAddress_unknownToken', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0xf91bcd8207bc850d4576fa008303c8fa947be8076f4ea4a4ad08075c2508e481d6c946d12b80b91b64a8a41c700000000000000000000000007be8076f4ea4a4ad08075c2508e481d6c946d12b000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f100000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000c99f70bfd82fb7c8f8191fdfbfb735606b15e5c50000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c02baa39b223fe8d0a0e5c4f27ead9083c756cc200000000000000000000000000000000000000000000000000000000000000fa0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000007ce66c50e28400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006094bdf600000000000000000000000000000000000000000000000000000000000000006050c7559c7884736a2bd436e458ae32b9c86b511130965ff6f6dc485eecbb26000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000003400000000000000000000000000000000000000000000000000000000000000f400000000000000000000000000000000000000000000000000000000000001b40000000000000000000000000000000000000000000000000000000000000001bb2de0411b316f8d6845f660d78ac11c123c6ae23054f33e49dc6b9d2c10c7d461649c2f3d6a8695dbf6f2766ff8b6a0cb05e0a402f7751d37cecec2e8f4e36eb0000000000000000000000000000000000000000000000000000000000000bc468f0bcaa0000000000000000000000000000000000000000000000000000000000000080000000000000000000000000000000000000000000000000000000000000026000000000000000000000000000000000000000000000000000000000000004400000000000000000000000000000000000000000000000000000000000000620000000000000000000000000000000000000000000000000000000000000000e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000ce5b23f11c486be7f8be4fac3b4ee6372d7ee91e000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e00000000000000000000000000000000000000000000000000000000000000640000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000006400000000000000000000000000000000000000000000000000000000000000640000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000006400000000000000000000000000000000000000000000000000000000000000640000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000006400000000000000000000000000000000000000000000000000000000000000640000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000006400000000000000000000000000000000000000000000000000000000000000640000000000000000000000000000000000000000000000000000000000000064000000000000000000000000000000000000000000000000000000000000057823b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000042023b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000042223b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000046023b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000055a23b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000056d23b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005ac23b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ca23b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000098123b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000009a723b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000017223b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001c123b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000032523b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f10000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000033b23b872dd000000000000000000000000603a8fd9c4d35dd8ddd41fc8a0d711777334b3f1000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000003670000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000bc40000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000026a0472e8d13ec71176b4ed35b0bcfa26d220b69e8c1af32b24d230b5c2eef88d64ba02f4e2ef3607d8c8412edeb3f241927b333ee9babfbce15b40f7957fd0a11eff5");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig,
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution,
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'nanos_cancelOrder_sell_bundle_nftAddress_unknownToken', [10, 0]);
  await tx;
}));

// https://etherscan.io/tx/0x318763e6bcad81edafc937d91315b1c0763368f8329876182dfc246189c9ef5e
test('[Nano S] newcancel_eth', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0x02f90612014d8459682f00850ec261fded83014025947f268357a8c2552623316e2562d90e642bb538e580b905a4a8a41c700000000000000000000000007f268357a8c2552623316e2562d90e642bb538e5000000000000000000000000dd41578ade12845b3f5b4271035e206b9ef1627800000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000baf2127b49fc93cbca6269fade0f7f31df4c88a70000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002ee00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000009b6e64a8ec600000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000006221ed480000000000000000000000000000000000000000000000000000000062233f1dc72c87310a155cce1f2c1aee38097e478c0b275a9e1a1dfd42af0f73f03d6b530000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000034000000000000000000000000000000000000000000000000000000000000004600000000000000000000000000000000000000000000000000000000000000580000000000000000000000000000000000000000000000000000000000000001b479f916fc7ca7d90d35171301a3b29a3b89798d7c5bdf62dd3466577bf9bdc2536feb23ae44592bc229d7109e5c20a2f7f8e8ec02ef3d3ca438c8d0aefd174af00000000000000000000000000000000000000000000000000000000000000e4fb16a595000000000000000000000000dd41578ade12845b3f5b4271035e206b9ef16278000000000000000000000000000000000000000000000000000000000000000000000000000000000000000082f5ef9ddc3d231962ba57a9c2ebb307dc8d26c20000000000000000000000000000000000000000000000000000000000000e5a000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e4000000000000000000000000000000000000000000000000000000000000000000000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c001a0cd25ca582921800b48834dcc8e28f1771449b6f3a3ecc20105c5f358fa23c58ba035af6132d7d12d549875f78c8770f7d42879ef66a037e151dca91cc92e066abb");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'newcancel_eth', [12, 0]);
  await tx;
}));

// https://etherscan.io/tx/0xd7386e1abfd622f9f182cfa373f2ef3f9073ef17af6fb020dc8f9fcfffe23d5b
test('[Nano S] newcancel_weth', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0x02f906130181978459682f00850dd9f2124e83014115947f268357a8c2552623316e2562d90e642bb538e580b905a4a8a41c700000000000000000000000007f268357a8c2552623316e2562d90e642bb538e50000000000000000000000002e5c8c9c3aa2bbb5bfbb915fca1cf74d4579f3cc00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000baf2127b49fc93cbca6269fade0f7f31df4c88a70000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c02aaa39b223fe8d0a0e5c4f27ead9083c756cc2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002ee0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005898862d161800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000062217552000000000000000000000000000000000000000000000000000000006222c7288f793646b14db9cd33fbee780a7c483401655fe7bedbcfcb8482f0374bf23ce40000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000034000000000000000000000000000000000000000000000000000000000000004600000000000000000000000000000000000000000000000000000000000000580000000000000000000000000000000000000000000000000000000000000001bdbf61dd49d97c70c3f938a84aaf0bd60d35d4d3d665f15de61726f1eac09a34e3ac8b3d6ed7945c4e27818197330375fdbbb21e225712ad5c822df4c7c2582c600000000000000000000000000000000000000000000000000000000000000e4fb16a59500000000000000000000000000000000000000000000000000000000000000000000000000000000000000002e5c8c9c3aa2bbb5bfbb915fca1cf74d4579f3cc000000000000000000000000c7df86762ba83f2a6197e1ff9bb40ae0f696b9e60000000000000000000000000000000000000000000000000000000000000728000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e400000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c080a05b8b73e972cab3c4258f7a2e35daa00ff4554aa283271c278589215d2606354ba0347b19e9c1893a59c0cacc6fbed17a196da9a4bbff02883d8f6de07b6061a48f");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'newcancel_weth', [11, 0]);
  await tx;
}));

// https://etherscan.io/tx/0xd7386e1abfd622f9f182cfa373f2ef3f9073ef17af6fb020dc8f9fcfffe23d5b // but WETH address is modified to raise unknown token warning. (c02aaa -> c02aab)
test('[Nano S] newcancel_unknown_token', zemu("nanos", async (sim, eth) => {
  const serializedTx = txFromEtherscan("0x02f906130181978459682f00850dd9f2124e83014115947f268357a8c2552623316e2562d90e642bb538e580b905a4a8a41c700000000000000000000000007f268357a8c2552623316e2562d90e642bb538e50000000000000000000000002e5c8c9c3aa2bbb5bfbb915fca1cf74d4579f3cc00000000000000000000000000000000000000000000000000000000000000000000000000000000000000005b3256965e7c3cf26e11fcaf296dfc8807c01073000000000000000000000000baf2127b49fc93cbca6269fade0f7f31df4c88a70000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c02aab39b223fe8d0a0e5c4f27ead9083c756cc2000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000002ee0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000005898862d161800000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000062217552000000000000000000000000000000000000000000000000000000006222c7288f793646b14db9cd33fbee780a7c483401655fe7bedbcfcb8482f0374bf23ce40000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000001000000000000000000000000000000000000000000000000000000000000034000000000000000000000000000000000000000000000000000000000000004600000000000000000000000000000000000000000000000000000000000000580000000000000000000000000000000000000000000000000000000000000001bdbf61dd49d97c70c3f938a84aaf0bd60d35d4d3d665f15de61726f1eac09a34e3ac8b3d6ed7945c4e27818197330375fdbbb21e225712ad5c822df4c7c2582c600000000000000000000000000000000000000000000000000000000000000e4fb16a59500000000000000000000000000000000000000000000000000000000000000000000000000000000000000002e5c8c9c3aa2bbb5bfbb915fca1cf74d4579f3cc000000000000000000000000c7df86762ba83f2a6197e1ff9bb40ae0f696b9e60000000000000000000000000000000000000000000000000000000000000728000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000e400000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c080a05b8b73e972cab3c4258f7a2e35daa00ff4554aa283271c278589215d2606354ba0347b19e9c1893a59c0cacc6fbed17a196da9a4bbff02883d8f6de07b6061a48f");
  const resolution = await ledgerService.resolveTransaction(
    serializedTx,
    loadConfig,
    resolutionConfig
  );
  const tx = eth.signTransaction(
    "44'/60'/0'/0",
    serializedTx,
    resolution
  );
  await waitForAppScreen(sim);
  await sim.navigateAndCompareSnapshots('.', 'newcancel_unknown_token', [11, 0]);
  await tx;
}));